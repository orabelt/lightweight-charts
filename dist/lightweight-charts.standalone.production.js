/*!
 * @license
 * TradingView Lightweight Charts v4.0.0-dev+202207121500
 * Copyright (c) 2022 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(){"use strict";var t,i;function s(t,i){const s={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[i];t.setLineDash(s)}function n(t,i,s,n){t.beginPath();const e=t.lineWidth%2?.5:0;t.moveTo(s,i+e),t.lineTo(n,i+e),t.stroke()}function e(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function r(t){if(void 0===t)throw new Error("Value is undefined");return t}function h(t){if(null===t)throw new Error("Value is null");return t}function l(t){return h(r(t))}!function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps",t[t.Curved=2]="Curved"}(t||(t={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(i||(i={}));const a={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function o(t){return t<0?0:t>255?255:Math.round(t)||0}function _(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}const u=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,c=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,d=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,f=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function p(t){(t=t.toLowerCase())in a&&(t=a[t]);{const i=f.exec(t)||d.exec(t);if(i)return[o(parseInt(i[1],10)),o(parseInt(i[2],10)),o(parseInt(i[3],10)),_(i.length<5?1:parseFloat(i[4]))]}{const i=c.exec(t);if(i)return[o(parseInt(i[1],16)),o(parseInt(i[2],16)),o(parseInt(i[3],16)),1]}{const i=u.exec(t);if(i)return[o(17*parseInt(i[1],16)),o(17*parseInt(i[2],16)),o(17*parseInt(i[3],16)),1]}throw new Error(`Cannot parse color: ${t}`)}function v(t){const i=p(t);return{t:`rgb(${i[0]}, ${i[1]}, ${i[2]})`,i:(s=i,.199*s[0]+.687*s[1]+.114*s[2]>160?"black":"white")};var s}class m{constructor(){this.h=[]}l(t,i,s){const n={o:t,_:i,u:!0===s};this.h.push(n)}p(t){const i=this.h.findIndex((i=>t===i.o));i>-1&&this.h.splice(i,1)}v(t){this.h=this.h.filter((i=>i._!==t))}m(t,i){const s=[...this.h];this.h=this.h.filter((t=>!t.u)),s.forEach((s=>s.o(t,i)))}g(){return this.h.length>0}M(){this.h=[]}}function w(t,...i){for(const s of i)for(const i in s)void 0!==s[i]&&("object"!=typeof s[i]||void 0===t[i]?t[i]=s[i]:w(t[i],s[i]));return t}function g(t){return"number"==typeof t&&isFinite(t)}function b(t){return"number"==typeof t&&t%1==0}function M(t){return"string"==typeof t}function S(t){return"boolean"==typeof t}function y(t){const i=t;if(!i||"object"!=typeof i)return i;let s,n,e;for(n in s=Array.isArray(i)?[]:{},i)i.hasOwnProperty(n)&&(e=i[n],s[n]=e&&"object"==typeof e?y(e):e);return s}function k(t){return null!==t}function x(t){return null===t?void 0:t}const T="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function C(t,i,s){return void 0===i&&(i=T),`${s=void 0!==s?`${s} `:""}${t}px ${i}`}class P{constructor(t){this.S={k:1,T:4,C:NaN,P:"",D:"",O:"",N:0,R:0,A:0,I:0,L:0},this.V=t}B(){const t=this.S,i=this.F(),s=this.W();return t.C===i&&t.D===s||(t.C=i,t.D=s,t.P=C(i,s),t.I=Math.floor(i/3.5),t.N=t.I,t.R=Math.max(Math.ceil(i/2-t.T/2),0),t.A=Math.ceil(i/2+t.T/2),t.L=Math.round(i/10)),t.O=this.j(),this.S}j(){return this.V.B().layout.textColor}F(){return this.V.B().layout.fontSize}W(){return this.V.B().layout.fontFamily}}class D{constructor(){this.$=[]}H(t){this.$=t}U(t,i,s,n){this.$.forEach((e=>{t.save(),e.U(t,i,s,n),t.restore()}))}}class E{U(t,i,s,n){t.save(),t.scale(i,i),this.q(t,s,n),t.restore()}Y(t,i,s,n){t.save(),t.scale(i,i),this.X(t,s,n),t.restore()}X(t,i,s){}}class O extends E{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null===this.K||null===this.K.G)return;const i=this.K.G,s=this.K,n=n=>{t.beginPath();for(let e=i.to-1;e>=i.from;--e){const i=s.J[e];t.moveTo(i.tt,i.it),t.arc(i.tt,i.it,n,0,2*Math.PI)}t.fill()};t.fillStyle=s.st,n(s.nt+2),t.fillStyle=s.et,n(s.nt)}}function N(){return{J:[{tt:0,it:0,rt:0,ht:0}],et:"",st:"",nt:0,G:null}}const R={from:0,to:1};class A{constructor(t,i){this.lt=new D,this.ot=[],this._t=[],this.ut=new Map,this.V=t,this.ct=i,this.lt.H(this.ot)}dt(t){const i=this.V.ft();i.length!==this.ot.length&&(this._t=i.map(N),this.ot=this._t.map((t=>{const i=new O;return i.Z(t),i})),this.lt.H(this.ot)),this.ut.clear()}vt(t,i,s,n){let e=this.ut.get(s);if(!e){e=this.wt(s,t),this.ut.set(s,e);const i=new D;return i.H(e),i}const r=new D;return r.H(e),r}wt(t,i){const s=this.V.ft().map(((t,i)=>[t,i])).filter((i=>t.gt().includes(i[0]))),n=this.ct.bt(),e=this.V.Mt();return s.map((([t,s])=>{var r;const l=this._t[s],a=t.St(n);if(null!==a&&t.yt()){const s=h(t.kt());l.et=a.xt,l.nt=a.nt,l.J[0].ht=a.ht,l.J[0].it=t.Ct().Tt(a.ht,s.Pt),l.st=null!==(r=a.Dt)&&void 0!==r?r:this.V.Et(l.J[0].it/i),l.J[0].rt=n,l.J[0].tt=e.Ot(n),l.G=R}else l.G=null;return this.ot[s]}))}}class I{constructor(t){this.Nt=t}U(t,i,e,r){if(null===this.Nt)return;const h=this.Nt.Rt.yt,l=this.Nt.At.yt;if(!h&&!l)return;t.save();const a=Math.round(this.Nt.tt*i),o=Math.round(this.Nt.it*i),_=Math.ceil(this.Nt.It*i),u=Math.ceil(this.Nt.Lt*i);t.lineCap="butt",h&&a>=0&&(t.lineWidth=Math.floor(this.Nt.Rt.Vt*i),t.strokeStyle=this.Nt.Rt.O,t.fillStyle=this.Nt.Rt.O,s(t,this.Nt.Rt.Bt),function(t,i,s,n){t.beginPath();const e=t.lineWidth%2?.5:0;t.moveTo(i+e,s),t.lineTo(i+e,n),t.stroke()}(t,a,0,u)),l&&o>=0&&(t.lineWidth=Math.floor(this.Nt.At.Vt*i),t.strokeStyle=this.Nt.At.O,t.fillStyle=this.Nt.At.O,s(t,this.Nt.At.Bt),n(t,o,0,_)),t.restore()}}class L{constructor(t){this.ut=new Map,this.Ft={Rt:{Vt:1,Bt:0,O:"",yt:!1},At:{Vt:1,Bt:0,O:"",yt:!1},It:0,Lt:0,tt:0,it:0},this.zt=new I(this.Ft),this.Wt=t}dt(){this.ut.clear()}vt(t,i,s){return this.wt(s),this.zt}wt(t){const i=this.Wt.yt(),s=h(this.Wt.$t()).jt().B().crosshair,n=this.Ft;n.At.yt=i&&this.Wt.Ht(t),n.Rt.yt=i&&this.Wt.Ut(),n.At.Vt=s.horzLine.width,n.At.Bt=s.horzLine.style,n.At.O=s.horzLine.color,n.Rt.Vt=s.vertLine.width,n.Rt.Bt=s.vertLine.style,n.Rt.O=s.vertLine.color,n.It=t.qt(),n.Lt=t.Yt(),n.tt=this.Wt.Xt(),n.it=this.Wt.Kt()}}function V(t,i,s,n,e,r){t.fillRect(i+r,s,n-2*r,r),t.fillRect(i+r,s+e-r,n-2*r,r),t.fillRect(i,s,r,e),t.fillRect(i+n-r,s,r,e)}function B(t,i,s){t.save(),t.scale(i,i),s(),t.restore()}function F(t,i,s,n,e,r){t.save(),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(i,s,n,e),t.restore()}function z(t,i,s,n,e,r,h){t.save(),t.globalCompositeOperation="copy";const l=t.createLinearGradient(0,0,0,e);l.addColorStop(0,r),l.addColorStop(1,h),t.fillStyle=l,t.fillRect(i,s,n,e),t.restore()}class W{constructor(t,i){this.Z(t,i)}Z(t,i){this.Nt=t,this.Zt=i}U(t,i,s,n,e,r){if(!this.Nt.yt)return;t.font=i.P;const h=this.Nt.Gt||!this.Nt.Jt?i.T:0,l=i.k,a=i.I,o=i.N,_=i.R,u=i.A,c=this.Nt.Qt,d=Math.ceil(s.ti(t,c)),f=i.L,p=i.C+a+o,v=Math.ceil(.5*p),m=l+d+_+u+h;let w=this.Zt.ii;this.Zt.si&&(w=this.Zt.si),w=Math.round(w);const g=w-v,b=g+p,M="right"===e,S=M?n:0,y=Math.ceil(n*r);let k,x,T=S;if(t.fillStyle=this.Zt.t,t.lineWidth=1,t.lineCap="butt",c){M?(T=S-m,k=S-h,x=T+u):(T=S+m,k=S+h,x=S+l+h+_);const i=Math.max(1,Math.floor(r)),s=Math.max(1,Math.floor(l*r)),n=M?y:0,e=Math.round(g*r),a=Math.round(T*r),d=Math.round(w*r)-Math.floor(.5*r),p=d+i+(d-e),v=Math.round(k*r);t.save(),t.beginPath(),t.moveTo(n,e),t.lineTo(a,e),t.lineTo(a,p),t.lineTo(n,p),t.fill(),t.fillStyle=this.Nt.Dt,t.fillRect(M?y-s:0,e,s,p-e),this.Nt.Gt&&(t.fillStyle=this.Zt.O,t.fillRect(n,d,v-n,i)),t.textAlign="left",t.fillStyle=this.Zt.O,B(t,r,(()=>{t.fillText(c,x,b-o-f)})),t.restore()}}Yt(t,i){return this.Nt.yt?t.C+t.I+t.N:0}}class j{constructor(t){this.ni={ii:0,O:"#FFF",t:"#000"},this.ei={Qt:"",yt:!1,Gt:!0,Jt:!1,Dt:""},this.ri={Qt:"",yt:!1,Gt:!1,Jt:!0,Dt:""},this.hi=!0,this.li=new(t||W)(this.ei,this.ni),this.ai=new(t||W)(this.ri,this.ni)}Qt(){return this.oi(),this.ei.Qt}ii(){return this.oi(),this.ni.ii}dt(){this.hi=!0}Yt(t,i=!1){return Math.max(this.li.Yt(t,i),this.ai.Yt(t,i))}_i(){return this.ni.si||0}ui(t){this.ni.si=t}ci(){return this.oi(),this.ei.yt||this.ri.yt}di(){return this.oi(),this.ei.yt}vt(t){return this.oi(),this.ei.Gt=this.ei.Gt&&t.B().ticksVisible,this.ri.Gt=this.ri.Gt&&t.B().ticksVisible,this.li.Z(this.ei,this.ni),this.ai.Z(this.ri,this.ni),this.li}fi(){return this.oi(),this.li.Z(this.ei,this.ni),this.ai.Z(this.ri,this.ni),this.ai}oi(){this.hi&&(this.ei.Gt=!0,this.ri.Gt=!1,this.pi(this.ei,this.ri,this.ni))}}class $ extends j{constructor(t,i,s){super(),this.Wt=t,this.vi=i,this.mi=s}pi(t,i,s){t.yt=!1;const n=this.Wt.B().horzLine;if(!n.labelVisible)return;const e=this.vi.kt();if(!this.Wt.yt()||this.vi.wi()||null===e)return;const r=v(n.labelBackgroundColor);s.t=r.t,s.O=r.i;const h=this.mi(this.vi);s.ii=h.ii,t.Qt=this.vi.gi(h.ht,e),t.yt=!0}}const H=/[1-9]/g;class U{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,s){if(null===this.Nt||!1===this.Nt.yt||0===this.Nt.Qt.length)return;t.font=i.P;const n=Math.round(i.bi.ti(t,this.Nt.Qt,H));if(n<=0)return;t.save();const e=i.Mi,r=n+2*e,l=r/2,a=this.Nt.qt;let o=this.Nt.ii,_=Math.floor(o-l)+.5;_<0?(o+=Math.abs(0-_),_=Math.floor(o-l)+.5):_+r>a&&(o-=Math.abs(a-(_+r)),_=Math.floor(o-l)+.5);const u=_+r,c=0+i.k+i.I+i.C+i.N;t.fillStyle=this.Nt.t;const d=Math.round(_*s),f=Math.round(0*s),p=Math.round(u*s),v=Math.round(c*s);if(t.fillRect(d,f,p-d,v-f),this.Nt.Gt){const n=Math.round(this.Nt.ii*s),e=f,r=Math.round((e+i.k+i.T)*s);t.fillStyle=this.Nt.O;const h=Math.max(1,Math.floor(s)),l=Math.floor(.5*s);t.fillRect(n-l,e,h,r-e)}const m=c-i.L-i.N;t.textAlign="left",t.fillStyle=this.Nt.O,B(t,s,(()=>{t.fillText(h(this.Nt).Qt,_+e,m)})),t.restore()}}class q{constructor(t,i,s){this.hi=!0,this.zt=new U,this.Ft={yt:!1,t:"#4c525e",O:"white",Qt:"",qt:0,ii:NaN,Gt:!0},this.ct=t,this.Si=i,this.mi=s}dt(){this.hi=!0}vt(){return this.hi&&(this.wt(),this.hi=!1),this.zt.Z(this.Ft),this.zt}wt(){const t=this.Ft;t.yt=!1;const i=this.ct.B().vertLine;if(!i.labelVisible)return;const s=this.Si.Mt();if(s.wi())return;t.qt=s.qt();const n=this.mi();if(!n.rt)return;t.ii=n.ii;const e=s.yi(this.ct.bt());t.Qt=s.ki(h(e)),t.yt=!0;const r=v(i.labelBackgroundColor);t.t=r.t,t.O=r.i,t.Gt=s.B().ticksVisible}}class Y{constructor(){this.xi=null,this.Ti=0}Ci(){return this.Ti}Pi(t){this.Ti=t}Ct(){return this.xi}Di(t){this.xi=t}Ei(t){return[]}Oi(){return[]}yt(){return!0}}var X;!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(X||(X={}));class K extends Y{constructor(t,i){super(),this.Ni=null,this.Ri=NaN,this.Ai=0,this.Ii=!0,this.Li=new Map,this.Vi=!1,this.Bi=NaN,this.Fi=NaN,this.zi=NaN,this.Wi=NaN,this.Si=t,this.ji=i,this.$i=new A(t,this);this.Hi=((t,i)=>s=>{const n=i(),e=t();if(s===h(this.Ni).Ui())return{ht:e,ii:n};{const t=h(s.kt());return{ht:s.qi(n,t),ii:n}}})((()=>this.Ri),(()=>this.Fi));const s=((t,i)=>()=>({rt:this.Si.Mt().Yi(t()),ii:i()}))((()=>this.Ai),(()=>this.Xt()));this.Xi=new q(this,t,s),this.Ki=new L(this)}B(){return this.ji}Zi(t,i){this.zi=t,this.Wi=i}Gi(){this.zi=NaN,this.Wi=NaN}Ji(){return this.zi}Qi(){return this.Wi}ts(t,i,s){this.Vi||(this.Vi=!0),this.Ii=!0,this.ss(t,i,s)}bt(){return this.Ai}Xt(){return this.Bi}Kt(){return this.Fi}yt(){return this.Ii}ns(){this.Ii=!1,this.es(),this.Ri=NaN,this.Bi=NaN,this.Fi=NaN,this.Ni=null,this.Gi()}rs(t){return null!==this.Ni?[this.Ki,this.$i]:[]}Ht(t){return t===this.Ni&&this.ji.horzLine.visible}Ut(){return this.ji.vertLine.visible}hs(t,i){this.Ii&&this.Ni===t||this.Li.clear();const s=[];return this.Ni===t&&s.push(this.ls(this.Li,i,this.Hi)),s}Oi(){return this.Ii?[this.Xi]:[]}$t(){return this.Ni}os(){this.Ki.dt(),this.Li.forEach((t=>t.dt())),this.Xi.dt(),this.$i.dt()}_s(t){return t&&!t.Ui().wi()?t.Ui():null}ss(t,i,s){this.us(t,i,s)&&this.os()}us(t,i,s){const n=this.Bi,e=this.Fi,r=this.Ri,h=this.Ai,l=this.Ni,a=this._s(s);this.Ai=t,this.Bi=isNaN(t)?NaN:this.Si.Mt().Ot(t),this.Ni=s;const o=null!==a?a.kt():null;return null!==a&&null!==o?(this.Ri=i,this.Fi=a.Tt(i,o)):(this.Ri=NaN,this.Fi=NaN),n!==this.Bi||e!==this.Fi||h!==this.Ai||r!==this.Ri||l!==this.Ni}es(){const t=this.Si.ft().map((t=>t.ds().cs())).filter(k),i=0===t.length?null:Math.max(...t);this.Ai=null!==i?i:NaN}ls(t,i,s){let n=t.get(i);return void 0===n&&(n=new $(this,i,s),t.set(i,n)),n}}function Z(t){return"left"===t||"right"===t}class G{constructor(t){this.fs=new Map,this.ps=[],this.vs=t}ws(t,i){const s=function(t,i){return void 0===t?i:{gs:Math.max(t.gs,i.gs),bs:t.bs||i.bs}}(this.fs.get(t),i);this.fs.set(t,s)}Ms(){return this.vs}Ss(t){const i=this.fs.get(t);return void 0===i?{gs:this.vs}:{gs:Math.max(this.vs,i.gs),bs:i.bs}}ys(){this.ps=[{ks:0}]}xs(t){this.ps=[{ks:1,Pt:t}]}Ts(){this.ps=[{ks:4}]}Cs(t){this.ps.push({ks:2,Pt:t})}Ps(t){this.ps.push({ks:3,Pt:t})}Ds(){return this.ps}Es(t){for(const i of t.ps)this.Os(i);this.vs=Math.max(this.vs,t.vs),t.fs.forEach(((t,i)=>{this.ws(i,t)}))}Os(t){switch(t.ks){case 0:this.ys();break;case 1:this.xs(t.Pt);break;case 2:this.Cs(t.Pt);break;case 3:this.Ps(t.Pt);break;case 4:this.Ts()}}}const J=".";function Q(t,i){if(!g(t))return"n/a";if(!b(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");if(0===i)return t.toString();return("0000000000000000"+t.toString()).slice(-i)}class tt{constructor(t,i){if(i||(i=1),g(t)&&b(t)||(t=100),t<0)throw new TypeError("invalid base");this.vi=t,this.Ns=i,this.Rs()}format(t){const i=t<0?"âˆ’":"";return t=Math.abs(t),i+this.As(t)}Rs(){if(this.Is=0,this.vi>0&&this.Ns>0){let t=this.vi;for(;t>1;)t/=10,this.Is++}}As(t){const i=this.vi/this.Ns;let s=Math.floor(t),n="";const e=void 0!==this.Is?this.Is:NaN;if(i>1){let r=+(Math.round(t*i)-s*i).toFixed(this.Is);r>=i&&(r-=i,s+=1),n=J+Q(+r.toFixed(this.Is)*this.Ns,e)}else s=Math.round(s*i)/i,e>0&&(n=J+Q(0,e));return s.toFixed(0)+n}}class it extends tt{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class st{constructor(t){this.Ls=t}format(t){let i="";return t<0&&(i="-",t=-t),t<995?i+this.Vs(t):t<999995?i+this.Vs(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Vs(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Vs(t/1e9)+"B")}Vs(t){let i;const s=Math.pow(10,this.Ls);return i=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this.Ls).replace(/\.?0+$/,""):String(t),i.replace(/(\.[1-9]*)0+$/,((t,i)=>i))}}function nt(t,i,s,n){if(0===i.length)return;const e=i[n.from].tt,r=i[n.from].it;t.moveTo(e,r);for(let e=n.from+1;e<n.to;++e){const n=i[e];switch(s){case 0:t.lineTo(n.tt,n.it);break;case 1:t.lineTo(n.tt,i[e-1].it),t.lineTo(n.tt,n.it);break;case 2:{const[s,r]=ht(i,e-1,e);t.bezierCurveTo(s.tt,s.it,r.tt,r.it,n.tt,n.it);break}}}}function et(t,i){return{tt:t.tt-i.tt,it:t.it-i.it}}function rt(t,i){return{tt:t.tt/i,it:t.it/i}}function ht(t,i,s){const n=Math.max(0,i-1),e=Math.min(t.length-1,s+1);var r,h;return[(r=t[i],h=rt(et(t[s],t[n]),6),{tt:r.tt+h.tt,it:r.it+h.it}),et(t[s],rt(et(t[e],t[i]),6))]}class lt extends E{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.K.Vt,s(t,this.K.Bt),t.lineWidth=1,t.beginPath(),1===this.K.J.length){const i=this.K.J[0],s=this.K.Bs/2;t.moveTo(i.tt-s,this.K.Fs),t.lineTo(i.tt-s,i.it),t.lineTo(i.tt+s,i.it),t.lineTo(i.tt+s,this.K.Fs)}else t.moveTo(this.K.J[this.K.G.from].tt,this.K.Fs),t.lineTo(this.K.J[this.K.G.from].tt,this.K.J[this.K.G.from].it),nt(t,this.K.J,this.K.zs,this.K.G),this.K.G.to>this.K.G.from&&(t.lineTo(this.K.J[this.K.G.to-1].tt,this.K.Fs),t.lineTo(this.K.J[this.K.G.from].tt,this.K.Fs));t.closePath(),t.fillStyle=this.Ws(t),t.fill()}}}class at extends lt{Ws(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.js);return s.addColorStop(0,i.$s),s.addColorStop(1,i.Hs),s}}class ot extends E{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G)if(t.lineCap="butt",t.lineWidth=this.K.Vt,s(t,this.K.Bt),t.strokeStyle=this.Us(t),t.lineJoin="round",1===this.K.J.length){t.beginPath();const i=this.K.J[0];t.moveTo(i.tt-this.K.Bs/2,i.it),t.lineTo(i.tt+this.K.Bs/2,i.it),void 0!==i.O&&(t.strokeStyle=i.O),t.stroke()}else this.qs(t,this.K)}qs(t,i){t.beginPath(),nt(t,i.J,i.zs,i.G),t.stroke()}}class _t extends ot{qs(t,i){var s,n;const{J:e,G:r,zs:h,et:l}=i;if(0===e.length||null===r)return;t.beginPath();const a=e[r.from];t.moveTo(a.tt,a.it);let o=null!==(s=a.O)&&void 0!==s?s:l;t.strokeStyle=o;const _=i=>{t.stroke(),t.beginPath(),t.strokeStyle=i,o=i};for(let i=r.from+1;i<r.to;++i){const s=e[i],r=null!==(n=s.O)&&void 0!==n?n:l;switch(h){case 0:t.lineTo(s.tt,s.it);break;case 1:t.lineTo(s.tt,e[i-1].it),r!==o&&(_(r),t.lineTo(s.tt,e[i-1].it)),t.lineTo(s.tt,s.it);break;case 2:{const[n,r]=ht(e,i-1,i);t.bezierCurveTo(n.tt,n.it,r.tt,r.it,s.tt,s.it);break}}1!==h&&r!==o&&(_(r),t.moveTo(s.tt,s.it))}t.stroke()}Us(){return this.K.et}}function ut(t,i,s,n=0,e=t.length){let r=e-n;for(;0<r;){const e=r>>1,h=n+e;s(t[h],i)?(n=h+1,r-=e+1):r=e}return n}function ct(t,i,s,n=0,e=t.length){let r=e-n;for(;0<r;){const e=r>>1,h=n+e;s(i,t[h])?r=e:(n=h+1,r-=e+1)}return n}function dt(t,i){return t.rt<i}function ft(t,i){return t<i.rt}function pt(t,i,s){const n=i.Ys(),e=i.Xs(),r=ut(t,n,dt),h=ct(t,e,ft);if(!s)return{from:r,to:h};let l=r,a=h;return r>0&&r<t.length&&t[r].rt>=n&&(l=r-1),h>0&&h<t.length&&t[h-1].rt<=e&&(a=h+1),{from:l,to:a}}class vt{constructor(t,i,s){this.Ks=!0,this.Zs=!0,this.Gs=!0,this.Js=[],this.Qs=null,this.tn=t,this.sn=i,this.nn=s}dt(t){this.Ks=!0,"data"===t&&(this.Zs=!0),"options"===t&&(this.Gs=!0)}en(){this.Zs&&(this.rn(),this.Zs=!1),this.Ks&&(this.hn(),this.Ks=!1),this.Gs&&(this.ln(),this.Gs=!1)}an(){this.Qs=null}hn(){const t=this.tn.Ct(),i=this.sn.Mt();if(this.an(),i.wi()||t.wi())return;const s=i.on();if(null===s)return;if(0===this.tn.ds()._n())return;const n=this.tn.kt();null!==n&&(this.Qs=pt(this.Js,s,this.nn),this.un(t,i,n.Pt))}}class mt extends vt{constructor(t,i){super(t,i,!0)}un(t,i,s){i.cn(this.Js,x(this.Qs)),t.dn(this.Js,s,x(this.Qs))}fn(t,i){return{rt:t,ht:i,tt:NaN,it:NaN}}ln(){}rn(){const t=this.tn.pn();this.Js=this.tn.ds().vn().map((i=>{const s=i.Pt[3];return this.mn(i.wn,s,t)}))}}class wt extends mt{constructor(t,i){super(t,i),this.zt=new D,this.gn=new at,this.bn=new _t,this.zt.H([this.gn,this.bn])}vt(t,i){if(!this.tn.yt())return null;const s=this.tn.B();return this.en(),this.gn.Z({zs:s.lineType,J:this.Js,Bt:s.lineStyle,Vt:s.lineWidth,$s:s.topColor,Hs:s.bottomColor,Fs:t,js:t,G:this.Qs,Bs:this.sn.Mt().Mn()}),this.bn.Z({zs:s.lineType,J:this.Js,et:s.lineColor,Bt:s.lineStyle,Vt:s.lineWidth,G:this.Qs,Bs:this.sn.Mt().Mn()}),this.zt}mn(t,i){return this.fn(t,i)}}class gt{constructor(){this.Nt=null,this.Sn=0,this.yn=0}Z(t){this.Nt=t}U(t,i,s,n){if(null===this.Nt||0===this.Nt.ds.length||null===this.Nt.G)return;if(this.Sn=this.kn(i),this.Sn>=2){Math.max(1,Math.floor(i))%2!=this.Sn%2&&this.Sn--}this.yn=this.Nt.xn?Math.min(this.Sn,Math.floor(i)):this.Sn;let e=null;const r=this.yn<=this.Sn&&this.Nt.Mn>=Math.floor(1.5*i);for(let s=this.Nt.G.from;s<this.Nt.G.to;++s){const n=this.Nt.ds[s];e!==n.O&&(t.fillStyle=n.O,e=n.O);const h=Math.floor(.5*this.yn),l=Math.round(n.tt*i),a=l-h,o=this.yn,_=a+o-1,u=Math.min(n.Tn,n.Cn),c=Math.max(n.Tn,n.Cn),d=Math.round(u*i)-h,f=Math.round(c*i)+h,p=Math.max(f-d,this.yn);t.fillRect(a,d,o,p);const v=Math.ceil(1.5*this.Sn);if(r){if(this.Nt.Pn){const s=l-v;let e=Math.max(d,Math.round(n.Dn*i)-h),r=e+o-1;r>d+p-1&&(r=d+p-1,e=r-o+1),t.fillRect(s,e,a-s,r-e+1)}const s=l+v;let e=Math.max(d,Math.round(n.En*i)-h),r=e+o-1;r>d+p-1&&(r=d+p-1,e=r-o+1),t.fillRect(_+1,e,s-_,r-e+1)}}}kn(t){const i=Math.floor(t);return Math.max(i,Math.floor(function(t,i){return Math.floor(.3*t*i)}(h(this.Nt).Mn,t)))}}class bt extends vt{constructor(t,i){super(t,i,!1)}un(t,i,s){i.cn(this.Js,x(this.Qs)),t.On(this.Js,s,x(this.Qs))}Nn(t,i,s){return{rt:t,Rn:i.Pt[0],An:i.Pt[1],In:i.Pt[2],Ln:i.Pt[3],tt:NaN,Dn:NaN,Tn:NaN,Cn:NaN,En:NaN}}rn(){const t=this.tn.pn();this.Js=this.tn.ds().vn().map((i=>this.mn(i.wn,i,t)))}}class Mt extends bt{constructor(){super(...arguments),this.zt=new gt}vt(t,i){if(!this.tn.yt())return null;const s=this.tn.B();this.en();const n={ds:this.Js,Mn:this.sn.Mt().Mn(),Pn:s.openVisible,xn:s.thinBars,G:this.Qs};return this.zt.Z(n),this.zt}ln(){this.Js.forEach((t=>{t.O=this.tn.pn().Bn(t.rt).Vn}))}mn(t,i,s){return Object.assign(Object.assign({},this.Nn(t,i,s)),{O:s.Bn(t).Vn})}}function St(t,i,s){return Math.min(Math.max(t,i),s)}function yt(t,i,s){return i-t<=s}function kt(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function xt(t){const i=Math.ceil(t);return i%2!=0?i-1:i}function Tt(t){const i=Math.ceil(t);return i%2==0?i-1:i}class Ct extends lt{Ws(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.js),n=St(i.Fs/i.js,0,1);return s.addColorStop(0,i.Fn),s.addColorStop(n,i.zn),s.addColorStop(n,i.Wn),s.addColorStop(1,i.jn),s}}class Pt extends ot{Us(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.js),n=St(i.Fs/i.js,0,1);return s.addColorStop(0,i.$s),s.addColorStop(n,i.$s),s.addColorStop(n,i.Hs),s.addColorStop(1,i.Hs),s}}class Dt extends mt{constructor(t,i){super(t,i),this.$n=new Ct,this.Hn=new Pt,this.lt=new D,this.lt.H([this.$n,this.Hn])}vt(t,i){if(!this.tn.yt())return null;const s=this.tn.kt();if(null===s)return null;const n=this.tn.B();this.en();const e=this.tn.Ct().Tt(n.baseValue.price,s.Pt),r=this.sn.Mt().Mn();return this.$n.Z({J:this.Js,Fn:n.topFillColor1,zn:n.topFillColor2,Wn:n.bottomFillColor1,jn:n.bottomFillColor2,Vt:n.lineWidth,Bt:n.lineStyle,zs:n.lineType,Fs:e,js:t,G:this.Qs,Bs:r}),this.Hn.Z({J:this.Js,$s:n.topLineColor,Hs:n.bottomLineColor,Vt:n.lineWidth,Bt:n.lineStyle,zs:n.lineType,Fs:e,js:t,G:this.Qs,Bs:r}),this.lt}mn(t,i){return this.fn(t,i)}}class Et{constructor(){this.Nt=null,this.Sn=0}Z(t){this.Nt=t}U(t,i,s,n){if(null===this.Nt||0===this.Nt.ds.length||null===this.Nt.G)return;if(this.Sn=function(t,i){if(t>=2.5&&t<=4)return Math.floor(3*i);const s=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),n=Math.floor(t*s*i),e=Math.floor(t*i),r=Math.min(n,e);return Math.max(Math.floor(i),r)}(this.Nt.Mn,i),this.Sn>=2){Math.floor(i)%2!=this.Sn%2&&this.Sn--}const e=this.Nt.ds;this.Nt.Un&&this.qn(t,e,this.Nt.G,i),this.Nt.Yn&&this.Xn(t,e,this.Nt.G,this.Nt.Mn,i);const r=this.Kn(i);(!this.Nt.Yn||this.Sn>2*r)&&this.Zn(t,e,this.Nt.G,i)}qn(t,i,s,n){if(null===this.Nt)return;let e="",r=Math.min(Math.floor(n),Math.floor(this.Nt.Mn*n));r=Math.max(Math.floor(n),Math.min(r,this.Sn));const h=Math.floor(.5*r);let l=null;for(let a=s.from;a<s.to;a++){const s=i[a];s.Gn!==e&&(t.fillStyle=s.Gn,e=s.Gn);const o=Math.round(Math.min(s.Dn,s.En)*n),_=Math.round(Math.max(s.Dn,s.En)*n),u=Math.round(s.Tn*n),c=Math.round(s.Cn*n);let d=Math.round(n*s.tt)-h;const f=d+r-1;null!==l&&(d=Math.max(l+1,d),d=Math.min(d,f));const p=f-d+1;t.fillRect(d,u,p,o-u),t.fillRect(d,_+1,p,c-_),l=f}}Kn(t){let i=Math.floor(1*t);this.Sn<=2*i&&(i=Math.floor(.5*(this.Sn-1)));const s=Math.max(Math.floor(t),i);return this.Sn<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Xn(t,i,s,n,e){if(null===this.Nt)return;let r="";const h=this.Kn(e);let l=null;for(let n=s.from;n<s.to;n++){const s=i[n];s.Dt!==r&&(t.fillStyle=s.Dt,r=s.Dt);let a=Math.round(s.tt*e)-Math.floor(.5*this.Sn);const o=a+this.Sn-1,_=Math.round(Math.min(s.Dn,s.En)*e),u=Math.round(Math.max(s.Dn,s.En)*e);if(null!==l&&(a=Math.max(l+1,a),a=Math.min(a,o)),this.Nt.Mn*e>2*h)V(t,a,_,o-a+1,u-_+1,h);else{const i=o-a+1;t.fillRect(a,_,i,u-_+1)}l=o}}Zn(t,i,s,n){if(null===this.Nt)return;let e="";const r=this.Kn(n);for(let h=s.from;h<s.to;h++){const s=i[h];let l=Math.round(Math.min(s.Dn,s.En)*n),a=Math.round(Math.max(s.Dn,s.En)*n),o=Math.round(s.tt*n)-Math.floor(.5*this.Sn),_=o+this.Sn-1;if(s.O!==e){const i=s.O;t.fillStyle=i,e=i}this.Nt.Yn&&(o+=r,l+=r,_-=r,a-=r),l>a||t.fillRect(o,l,_-o+1,a-l+1)}}}class Ot extends bt{constructor(){super(...arguments),this.zt=new Et}vt(t,i){if(!this.tn.yt())return null;const s=this.tn.B();this.en();const n={ds:this.Js,Mn:this.sn.Mt().Mn(),Un:s.wickVisible,Yn:s.borderVisible,G:this.Qs};return this.zt.Z(n),this.zt}ln(){this.Js.forEach((t=>{const i=this.tn.pn().Bn(t.rt);t.O=i.Vn,t.Gn=i.Jn,t.Dt=i.Qn}))}mn(t,i,s){const n=s.Bn(t);return Object.assign(Object.assign({},this.Nn(t,i,s)),{O:n.Vn,Gn:n.Jn,Dt:n.Qn})}}class Nt{constructor(){this.Nt=null,this.te=[]}Z(t){this.Nt=t,this.te=[]}U(t,i,s,n){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return;this.te.length||this.ie(i);const e=Math.max(1,Math.floor(i)),r=Math.round(this.Nt.se*i)-Math.floor(e/2),h=r+e;for(let s=this.Nt.G.from;s<this.Nt.G.to;s++){const n=this.Nt.J[s],l=this.te[s-this.Nt.G.from],a=Math.round(n.it*i);let o,_;t.fillStyle=n.O,a<=r?(o=a,_=h):(o=r,_=a-Math.floor(e/2)+e),t.fillRect(l.Ys,o,l.Xs-l.Ys+1,_-o)}}ie(t){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return void(this.te=[]);const i=Math.ceil(this.Nt.Mn*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.Nt.Mn*t)-i;this.te=new Array(this.Nt.G.to-this.Nt.G.from);for(let i=this.Nt.G.from;i<this.Nt.G.to;i++){const n=this.Nt.J[i],e=Math.round(n.tt*t);let r,h;if(s%2){const t=(s-1)/2;r=e-t,h=e+t}else{const t=s/2;r=e-t,h=e+t-1}this.te[i-this.Nt.G.from]={Ys:r,Xs:h,ne:e,ee:n.tt*t,rt:n.rt}}for(let t=this.Nt.G.from+1;t<this.Nt.G.to;t++){const s=this.te[t-this.Nt.G.from],n=this.te[t-this.Nt.G.from-1];s.rt===n.rt+1&&(s.Ys-n.Xs!==i+1&&(n.ne>n.ee?n.Xs=s.Ys-i-1:s.Ys=n.Xs+i+1))}let n=Math.ceil(this.Nt.Mn*t);for(let t=this.Nt.G.from;t<this.Nt.G.to;t++){const i=this.te[t-this.Nt.G.from];i.Xs<i.Ys&&(i.Xs=i.Ys);const s=i.Xs-i.Ys+1;n=Math.min(s,n)}if(i>0&&n<4)for(let t=this.Nt.G.from;t<this.Nt.G.to;t++){const i=this.te[t-this.Nt.G.from];i.Xs-i.Ys+1>n&&(i.ne>i.ee?i.Xs-=1:i.Ys+=1)}}}function Rt(t){return{J:[],Mn:t,se:NaN,G:null}}function At(t,i,s){return{rt:t,ht:i,tt:NaN,it:NaN,O:s}}class It extends vt{constructor(t,i){super(t,i,!1),this.lt=new D,this.re=Rt(0),this.zt=new Nt}vt(t,i){return this.tn.yt()?(this.en(),this.lt):null}rn(){const t=this.sn.Mt().Mn();this.re=Rt(t);let i=0,s=0;const n=this.tn.B().color;for(const t of this.tn.ds().vn()){const e=t.Pt[3],r=void 0!==t.O?t.O:n,h=At(t.wn,e,r);i++,i<this.re.J.length?this.re.J[i]=h:this.re.J.push(h),this.Js[s++]={rt:t.wn,tt:0}}this.zt.Z(this.re),this.lt.H([this.zt])}ln(){}an(){super.an(),this.re.G=null}un(t,i,s){if(null===this.Qs)return;const n=i.Mn(),e=h(i.on()),r=t.Tt(this.tn.B().base,s);i.cn(this.re.J),t.dn(this.re.J,s),this.re.se=r,this.re.G=pt(this.re.J,e,!1),this.re.Mn=n,this.zt.Z(this.re)}}class Lt extends mt{constructor(t,i){super(t,i),this.bn=new _t}vt(t,i){if(!this.tn.yt())return null;const s=this.tn.B();this.en();const n={J:this.Js,et:s.color,Bt:s.lineStyle,zs:s.lineType,Vt:s.lineWidth,G:this.Qs,Bs:this.sn.Mt().Mn()};return this.bn.Z(n),this.bn}ln(){this.Js.forEach((t=>{t.O=this.tn.pn().Bn(t.rt).Vn}))}mn(t,i,s){const n=this.fn(t,i);return n.O=s.Bn(t).Vn,n}}const Vt=/[2-9]/g;class Bt{constructor(t=50){this.he=new Map,this.le=0,this.ae=Array.from(new Array(t))}oe(){this.he.clear(),this.ae.fill(void 0)}ti(t,i,s){const n=s||Vt,e=String(i).replace(n,"0");let r=this.he.get(e);if(void 0===r){if(r=t.measureText(e).width,0===r&&0!==i.length)return 0;const s=this.ae[this.le];void 0!==s&&this.he.delete(s),this.ae[this.le]=e,this.le=(this.le+1)%this.ae.length,this.he.set(e,r)}return r}}class Ft{constructor(t){this._e=null,this.S=null,this.ue="right",this.ce=0,this.de=t}fe(t,i,s,n){this._e=t,this.S=i,this.ce=s,this.ue=n}U(t,i){null!==this.S&&null!==this._e&&this._e.U(t,this.S,this.de,this.ce,this.ue,i)}}class zt{constructor(t,i,s){this.pe=t,this.de=new Bt(50),this.ve=i,this.V=s,this.F=-1,this.zt=new Ft(this.de)}vt(t,i){const s=this.V.me(this.ve);if(null===s)return null;const n=s.we(this.ve)?s.ge():this.ve.Ct();if(null===n)return null;const e=s.be(n);if("overlay"===e)return null;const r=this.V.Me();return r.C!==this.F&&(this.F=r.C,this.de.oe()),this.zt.fe(this.pe.fi(),r,i,e),this.zt}}class Wt{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,e,r){if(null===this.Nt)return;if(!1===this.Nt.yt)return;const h=Math.round(this.Nt.it*i);if(h<0||h>Math.ceil(this.Nt.Yt*i))return;const l=Math.ceil(this.Nt.qt*i);t.lineCap="butt",t.strokeStyle=this.Nt.O,t.lineWidth=Math.floor(this.Nt.Vt*i),s(t,this.Nt.Bt),n(t,h,0,l)}}class jt{constructor(t){this.Se={qt:0,Yt:0,it:0,O:"rgba(0, 0, 0, 0)",Vt:1,Bt:0,yt:!1},this.ye=new Wt,this.hi=!0,this.tn=t,this.sn=t.jt(),this.ye.Z(this.Se)}dt(){this.hi=!0}vt(t,i){return this.tn.yt()?(this.hi&&(this.ke(t,i),this.hi=!1),this.ye):null}}class $t extends jt{constructor(t){super(t)}ke(t,i){this.Se.yt=!1;const s=this.tn.Ct(),n=s.xe().xe;if(2!==n&&3!==n)return;const e=this.tn.B();if(!e.baseLineVisible||!this.tn.yt())return;const r=this.tn.kt();null!==r&&(this.Se.yt=!0,this.Se.it=s.Tt(r.Pt,r.Pt),this.Se.qt=i,this.Se.Yt=t,this.Se.O=e.baseLineColor,this.Se.Vt=e.baseLineWidth,this.Se.Bt=e.baseLineStyle)}}class Ht{constructor(){this.Nt=null}Z(t){this.Nt=t}Te(){return this.Nt}U(t,i,s,n){const e=this.Nt;if(null===e)return;t.save();const r=Math.max(1,Math.floor(i)),h=r%2/2,l=Math.round(e.ee.x*i)+h,a=e.ee.y*i;t.fillStyle=e.Ce,t.beginPath();const o=Math.max(2,1.5*e.Pe)*i;t.arc(l,a,o,0,2*Math.PI,!1),t.fill(),t.fillStyle=e.De,t.beginPath(),t.arc(l,a,e.nt*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=e.Ee,t.beginPath(),t.arc(l,a,e.nt*i+r/2,0,2*Math.PI,!1),t.stroke(),t.restore()}}const Ut=[{Oe:0,Ne:.25,Re:4,Ae:10,Ie:.25,Le:0,Ve:.4,Be:.8},{Oe:.25,Ne:.525,Re:10,Ae:14,Ie:0,Le:0,Ve:.8,Be:0},{Oe:.525,Ne:1,Re:14,Ae:14,Ie:0,Le:0,Ve:0,Be:0}];function qt(t,i,s,n){return function(t,i){if("transparent"===t)return t;const s=p(t),n=s[3];return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${i*n})`}(t,s+(n-s)*i)}function Yt(t,i){const s=t%2600/2600;let n;for(const t of Ut)if(s>=t.Oe&&s<=t.Ne){n=t;break}e(void 0!==n,"Last price animation internal logic error");const r=(s-n.Oe)/(n.Ne-n.Oe);return{De:qt(i,r,n.Ie,n.Le),Ee:qt(i,r,n.Ve,n.Be),nt:(h=r,l=n.Re,a=n.Ae,l+(a-l)*h)};var h,l,a}class Xt{constructor(t){this.zt=new Ht,this.hi=!0,this.Fe=!0,this.ze=performance.now(),this.We=this.ze-1,this.je=t}$e(){this.We=this.ze-1,this.dt()}He(){if(this.dt(),2===this.je.B().lastPriceAnimation){const t=performance.now(),i=this.We-t;if(i>0)return void(i<650&&(this.We+=2600));this.ze=t,this.We=t+2600}}dt(){this.hi=!0}Ue(){this.Fe=!0}yt(){return 0!==this.je.B().lastPriceAnimation}qe(){switch(this.je.B().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.We}}vt(t,i){return this.hi?(this.wt(t,i),this.hi=!1,this.Fe=!1):this.Fe&&(this.Ye(),this.Fe=!1),this.zt}wt(t,i){this.zt.Z(null);const s=this.je.jt().Mt(),n=s.on(),e=this.je.kt();if(null===n||null===e)return;const r=this.je.Xe(!0);if(r.Ke||!n.Ze(r.wn))return;const h={x:s.Ot(r.wn),y:this.je.Ct().Tt(r.ht,e.Pt)},l=r.O,a=this.je.B().lineWidth,o=Yt(this.Ge(),l);this.zt.Z({Ce:l,Pe:a,De:o.De,Ee:o.Ee,nt:o.nt,ee:h})}Ye(){const t=this.zt.Te();if(null!==t){const i=Yt(this.Ge(),t.Ce);t.De=i.De,t.Ee=i.Ee,t.nt=i.nt}}Ge(){return this.qe()?performance.now()-this.ze:2599}}function Kt(t,i){return Tt(Math.min(Math.max(t,12),30)*i)}function Zt(t,i){switch(t){case"arrowDown":case"arrowUp":return Kt(i,1);case"circle":return Kt(i,.8);case"square":return Kt(i,.7)}}function Gt(t){return xt(Kt(t,1))}function Jt(t){return Math.max(Kt(t,.1),3)}function Qt(t,i,s,n,e){const r=Zt("square",s),h=(r-1)/2,l=t-h,a=i-h;return n>=l&&n<=l+r&&e>=a&&e<=a+r}function ti(t,i,s,n,e){const r=(Zt("arrowUp",e)-1)/2,h=(Tt(e/2)-1)/2;i.beginPath(),t?(i.moveTo(s-r,n),i.lineTo(s,n-r),i.lineTo(s+r,n),i.lineTo(s+h,n),i.lineTo(s+h,n+r),i.lineTo(s-h,n+r),i.lineTo(s-h,n)):(i.moveTo(s-r,n),i.lineTo(s,n+r),i.lineTo(s+r,n),i.lineTo(s+h,n),i.lineTo(s+h,n-r),i.lineTo(s-h,n-r),i.lineTo(s-h,n)),i.fill()}function ii(t,i,s,n,e,r){return Qt(i,s,n,e,r)}class si extends E{constructor(){super(...arguments),this.Nt=null,this.de=new Bt,this.F=-1,this.W="",this.Je=""}Z(t){this.Nt=t}fe(t,i){this.F===t&&this.W===i||(this.F=t,this.W=i,this.Je=C(t,i),this.de.oe())}Qe(t,i){if(null===this.Nt||null===this.Nt.G)return null;for(let s=this.Nt.G.from;s<this.Nt.G.to;s++){const n=this.Nt.J[s];if(ei(n,t,i))return{tr:n.ir,sr:n.sr}}return null}q(t,i,s){if(null!==this.Nt&&null!==this.Nt.G){t.textBaseline="middle",t.font=this.Je;for(let i=this.Nt.G.from;i<this.Nt.G.to;i++){const s=this.Nt.J[i];void 0!==s.Qt&&(s.Qt.qt=this.de.ti(t,s.Qt.nr),s.Qt.Yt=this.F),ni(s,t)}}}}function ni(t,i){i.fillStyle=t.O,void 0!==t.Qt&&function(t,i,s,n){t.fillText(i,s,n)}(i,t.Qt.nr,t.tt-t.Qt.qt/2,t.Qt.it),function(t,i){if(0===t._n)return;switch(t.er){case"arrowDown":return void ti(!1,i,t.tt,t.it,t._n);case"arrowUp":return void ti(!0,i,t.tt,t.it,t._n);case"circle":return void function(t,i,s,n){const e=(Zt("circle",n)-1)/2;t.beginPath(),t.arc(i,s,e,0,2*Math.PI,!1),t.fill()}(i,t.tt,t.it,t._n);case"square":return void function(t,i,s,n){const e=Zt("square",n),r=(e-1)/2,h=i-r,l=s-r;t.fillRect(h,l,e,e)}(i,t.tt,t.it,t._n)}t.er}(t,i)}function ei(t,i,s){return!(void 0===t.Qt||!function(t,i,s,n,e,r){const h=n/2;return e>=t&&e<=t+s&&r>=i-h&&r<=i+h}(t.tt,t.Qt.it,t.Qt.qt,t.Qt.Yt,i,s))||function(t,i,s){if(0===t._n)return!1;switch(t.er){case"arrowDown":case"arrowUp":return ii(0,t.tt,t.it,t._n,i,s);case"circle":return function(t,i,s,n,e){const r=2+Zt("circle",s)/2,h=t-n,l=i-e;return Math.sqrt(h*h+l*l)<=r}(t.tt,t.it,t._n,i,s);case"square":return Qt(t.tt,t.it,t._n,i,s)}}(t,i,s)}function ri(t,i,s,n,e,r,h,l,a){const o=g(s)?s:s.Ln,_=g(s)?s:s.An,u=g(s)?s:s.In,c=g(i.size)?Math.max(i.size,0):1,d=Gt(l.Mn())*c,f=d/2;switch(t._n=d,i.position){case"inBar":return t.it=h.Tt(o,a),void(void 0!==t.Qt&&(t.Qt.it=t.it+f+r+.6*e));case"aboveBar":return t.it=h.Tt(_,a)-f-n.rr,void 0!==t.Qt&&(t.Qt.it=t.it-f-.6*e,n.rr+=1.2*e),void(n.rr+=d+r);case"belowBar":return t.it=h.Tt(u,a)+f+n.hr,void 0!==t.Qt&&(t.Qt.it=t.it+f+r+.6*e,n.hr+=1.2*e),void(n.hr+=d+r)}i.position}class hi{constructor(t,i){this.hi=!0,this.lr=!0,this.ar=!0,this._r=null,this.zt=new si,this.je=t,this.Si=i,this.Nt={J:[],G:null}}dt(t){this.hi=!0,this.ar=!0,"data"===t&&(this.lr=!0)}vt(t,i,s,n){if(!this.je.yt())return null;this.hi&&this.en();const e=this.Si.B().layout;return this.zt.fe(e.fontSize,e.fontFamily),this.zt.Z(this.Nt),this.zt}ur(){if(this.ar){if(this.je.cr().length>0){const t=this.Si.Mt().Mn(),i=Jt(t),s=1.5*Gt(t)+2*i;this._r={above:s,below:s}}else this._r=null;this.ar=!1}return this._r}en(){const t=this.je.Ct(),i=this.Si.Mt(),s=this.je.cr();this.lr&&(this.Nt.J=s.map((t=>({rt:t.time,tt:0,it:0,_n:0,er:t.shape,O:t.color,ir:t.internalId,sr:t.id,Qt:void 0}))),this.lr=!1);const n=this.Si.B().layout;this.Nt.G=null;const e=i.on();if(null===e)return;const r=this.je.kt();if(null===r)return;if(0===this.Nt.J.length)return;let h=NaN;const l=Jt(i.Mn()),a={rr:l,hr:l};this.Nt.G=pt(this.Nt.J,e,!0);for(let e=this.Nt.G.from;e<this.Nt.G.to;e++){const o=s[e];o.time!==h&&(a.rr=l,a.hr=l,h=o.time);const _=this.Nt.J[e];_.tt=i.Ot(o.time),void 0!==o.text&&o.text.length>0&&(_.Qt={nr:o.text,it:0,qt:0,Yt:0});const u=this.je.dr(o.time);null!==u&&ri(_,o,u,a,n.fontSize,l,t,i,r.Pt)}this.hi=!1}}class li extends jt{constructor(t){super(t)}ke(t,i){const s=this.Se;s.yt=!1;const n=this.tn.B();if(!n.priceLineVisible||!this.tn.yt())return;const e=this.tn.Xe(0===n.priceLineSource);e.Ke||(s.yt=!0,s.it=e.ii,s.O=this.tn.pr(e.O),s.qt=i,s.Yt=t,s.Vt=n.priceLineWidth,s.Bt=n.priceLineStyle)}}class ai extends j{constructor(t){super(),this.Wt=t}pi(t,i,s){t.yt=!1,i.yt=!1;const n=this.Wt;if(!n.yt())return;const e=n.B(),r=e.lastValueVisible,h=""!==n.vr(),l=0===e.seriesLastValueMode,a=n.Xe(!1);if(a.Ke)return;r&&(t.Qt=this.mr(a,r,l),t.yt=0!==t.Qt.length),(h||l)&&(i.Qt=this.wr(a,r,h,l),i.yt=i.Qt.length>0);const o=n.pr(a.O),_=v(o);s.t=_.t,s.O=_.i,s.ii=a.ii,i.Dt=n.jt().Et(a.ii/n.Ct().Yt()),t.Dt=o}wr(t,i,s,n){let e="";const r=this.Wt.vr();return s&&0!==r.length&&(e+=`${r} `),i&&n&&(e+=this.Wt.Ct().gr()?t.br:t.Mr),e.trim()}mr(t,i,s){return i?s?this.Wt.Ct().gr()?t.Mr:t.br:t.Qt:""}}class oi{constructor(t,i){this.Sr=t,this.yr=i}kr(t){return null!==t&&(this.Sr===t.Sr&&this.yr===t.yr)}Tr(){return new oi(this.Sr,this.yr)}Cr(){return this.Sr}Pr(){return this.yr}Dr(){return this.yr-this.Sr}wi(){return this.yr===this.Sr||Number.isNaN(this.yr)||Number.isNaN(this.Sr)}Es(t){return null===t?this:new oi(Math.min(this.Cr(),t.Cr()),Math.max(this.Pr(),t.Pr()))}Er(t){if(!g(t))return;if(0===this.yr-this.Sr)return;const i=.5*(this.yr+this.Sr);let s=this.yr-i,n=this.Sr-i;s*=t,n*=t,this.yr=i+s,this.Sr=i+n}Or(t){g(t)&&(this.yr+=t,this.Sr+=t)}Nr(){return{minValue:this.Sr,maxValue:this.yr}}static Rr(t){return null===t?null:new oi(t.minValue,t.maxValue)}}class _i{constructor(t,i){this.Ar=t,this.Ir=i||null}Lr(){return this.Ar}Vr(){return this.Ir}Nr(){return null===this.Ar?null:{priceRange:this.Ar.Nr(),margins:this.Ir||void 0}}static Rr(t){return null===t?null:new _i(oi.Rr(t.priceRange),t.margins)}}class ui extends jt{constructor(t,i){super(t),this.Br=i}ke(t,i){const s=this.Se;s.yt=!1;const n=this.Br.B();if(!this.tn.yt()||!n.lineVisible)return;const e=this.Br.Fr();null!==e&&(s.yt=!0,s.it=e,s.O=n.color,s.qt=i,s.Yt=t,s.Vt=n.lineWidth,s.Bt=n.lineStyle)}}class ci extends j{constructor(t,i){super(),this.je=t,this.Br=i}pi(t,i,s){t.yt=!1,i.yt=!1;const n=this.Br.B(),e=n.axisLabelVisible,r=""!==n.title,h=this.je;if(!e||!h.yt())return;const l=this.Br.Fr();if(null===l)return;r&&(i.Qt=n.title,i.yt=!0),i.Dt=h.jt().Et(l/h.Ct().Yt()),t.Qt=this.zr(n.price),t.yt=!0;const a=v(n.color);s.t=a.t,s.O=a.i,s.ii=l}zr(t){const i=this.je.kt();return null===i?"":this.je.Ct().gi(t,i.Pt)}}class di{constructor(t,i){this.je=t,this.ji=i,this.Wr=new ui(t,this),this.pe=new ci(t,this),this.jr=new zt(this.pe,t,t.jt())}$r(t){w(this.ji,t),this.dt(),this.je.jt().Hr()}B(){return this.ji}Ur(){return this.Wr}qr(){return this.jr}Yr(){return this.pe}dt(){this.Wr.dt(),this.pe.dt()}Fr(){const t=this.je,i=t.Ct();if(t.jt().Mt().wi()||i.wi())return null;const s=t.kt();return null===s?null:i.Tt(this.ji.price,s.Pt)}}class fi extends Y{constructor(t){super(),this.Si=t}jt(){return this.Si}}const pi={Vn:"",Qn:"",Jn:""};class vi{constructor(t){this.je=t}Bn(t,i){const s=this.je.Xr(),n=this.je.B();switch(s){case"Line":return this.Kr(n,t,i);case"Area":return this.Zr(n);case"Baseline":return this.Gr(n,t,i);case"Bar":return this.Jr(n,t,i);case"Candlestick":return this.Qr(n,t,i);case"Histogram":return this.th(n,t,i)}throw new Error("Unknown chart style")}Jr(t,i,s){const n=Object.assign({},pi),e=t.upColor,r=t.downColor,a=e,o=r,_=h(this.ih(i,s)),u=l(_.Pt[0])<=l(_.Pt[3]);return void 0!==_.O?(n.Vn=_.O,n.Qn=_.O):(n.Vn=u?e:r,n.Qn=u?a:o),n}Qr(t,i,s){var n,e,r;const a=Object.assign({},pi),o=t.upColor,_=t.downColor,u=t.borderUpColor,c=t.borderDownColor,d=t.wickUpColor,f=t.wickDownColor,p=h(this.ih(i,s)),v=l(p.Pt[0])<=l(p.Pt[3]);return a.Vn=null!==(n=p.O)&&void 0!==n?n:v?o:_,a.Qn=null!==(e=p.Dt)&&void 0!==e?e:v?u:c,a.Jn=null!==(r=p.Gn)&&void 0!==r?r:v?d:f,a}Zr(t){return Object.assign(Object.assign({},pi),{Vn:t.lineColor})}Gr(t,i,s){const n=h(this.ih(i,s)).Pt[3]>=t.baseValue.price;return Object.assign(Object.assign({},pi),{Vn:n?t.topLineColor:t.bottomLineColor})}Kr(t,i,s){var n;const e=h(this.ih(i,s));return Object.assign(Object.assign({},pi),{Vn:null!==(n=e.O)&&void 0!==n?n:t.color})}th(t,i,s){const n=Object.assign({},pi),e=h(this.ih(i,s));return n.Vn=void 0!==e.O?e.O:t.color,n}ih(t,i){return void 0!==i?i.Pt:this.je.ds().sh(t)}}var mi;!function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.None=0]="None",t[t.NearestRight=1]="NearestRight"}(mi||(mi={}));const wi=30;class gi{constructor(){this.nh=[],this.eh=new Map,this.rh=new Map}hh(){return this._n()>0?this.nh[this.nh.length-1]:null}lh(){return this._n()>0?this.ah(0):null}cs(){return this._n()>0?this.ah(this.nh.length-1):null}_n(){return this.nh.length}wi(){return 0===this._n()}Ze(t){return null!==this.oh(t,0)}sh(t){return this._h(t)}_h(t,i=0){const s=this.oh(t,i);return null===s?null:Object.assign(Object.assign({},this.uh(s)),{wn:this.ah(s)})}vn(){return this.nh}dh(t,i,s){if(this.wi())return null;let n=null;for(const e of s){n=bi(n,this.fh(t,i,e))}return n}Z(t){this.rh.clear(),this.eh.clear(),this.nh=t}ah(t){return this.nh[t].wn}uh(t){return this.nh[t]}oh(t,i){const s=this.ph(t);if(null===s&&0!==i)switch(i){case-1:return this.mh(t);case 1:return this.wh(t);default:throw new TypeError("Unknown search mode")}return s}mh(t){let i=this.gh(t);return i>0&&(i-=1),i!==this.nh.length&&this.ah(i)<t?i:null}wh(t){const i=this.bh(t);return i!==this.nh.length&&t<this.ah(i)?i:null}ph(t){const i=this.gh(t);return i===this.nh.length||t<this.nh[i].wn?null:i}gh(t){return ut(this.nh,t,((t,i)=>t.wn<i))}bh(t){return ct(this.nh,t,((t,i)=>i.wn>t))}Mh(t,i,s){let n=null;for(let e=t;e<i;e++){const t=this.nh[e].Pt[s];Number.isNaN(t)||(null===n?n={Sh:t,yh:t}:(t<n.Sh&&(n.Sh=t),t>n.yh&&(n.yh=t)))}return n}fh(t,i,s){if(this.wi())return null;let n=null;const e=h(this.lh()),r=h(this.cs()),l=Math.max(t,e),a=Math.min(i,r),o=Math.ceil(l/wi)*wi,_=Math.max(o,Math.floor(a/wi)*wi);{const t=this.gh(l),e=this.bh(Math.min(a,o,i));n=bi(n,this.Mh(t,e,s))}let u=this.eh.get(s);void 0===u&&(u=new Map,this.eh.set(s,u));for(let t=Math.max(o+1,l);t<_;t+=wi){const i=Math.floor(t/wi);let e=u.get(i);if(void 0===e){const t=this.gh(i*wi),n=this.bh((i+1)*wi-1);e=this.Mh(t,n,s),u.set(i,e)}n=bi(n,e)}{const t=this.gh(_),i=this.bh(a);n=bi(n,this.Mh(t,i,s))}return n}}function bi(t,i){if(null===t)return i;if(null===i)return t;return{Sh:Math.min(t.Sh,i.Sh),yh:Math.max(t.yh,i.yh)}}class Mi extends fi{constructor(t,i,s){super(t),this.Nt=new gi,this.Wr=new li(this),this.kh=[],this.xh=new $t(this),this.Th=null,this.Ch=null,this.Ph=[],this.Dh=[],this.Eh=null,this.ji=i,this.Oh=s;const n=new ai(this);this.Li=[n],this.jr=new zt(n,this,t),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(this.Th=new Xt(this)),this.Nh(),this.Rh()}M(){null!==this.Eh&&clearTimeout(this.Eh)}pr(t){return this.ji.priceLineColor||t}Xe(t){const i={Ke:!0},s=this.Ct();if(this.jt().Mt().wi()||s.wi()||this.Nt.wi())return i;const n=this.jt().Mt().on(),e=this.kt();if(null===n||null===e)return i;let r,h;if(t){const t=this.Nt.hh();if(null===t)return i;r=t,h=t.wn}else{const t=this.Nt._h(n.Xs(),-1);if(null===t)return i;if(r=this.Nt.sh(t.wn),null===r)return i;h=t.wn}const l=r.Pt[3],a=this.pn().Bn(h,{Pt:r}),o=s.Tt(l,e.Pt);return{Ke:!1,ht:l,Qt:s.gi(l,e.Pt),br:s.Ah(l),Mr:s.Ih(l,e.Pt),O:a.Vn,ii:o,wn:h}}pn(){return null!==this.Ch||(this.Ch=new vi(this)),this.Ch}B(){return this.ji}$r(t){var i;const s=t.priceScaleId;void 0!==s&&s!==this.ji.priceScaleId&&this.jt().Lh(this,s);const n=null!==(i=this.ji.pane)&&void 0!==i?i:0;w(this.ji,t),void 0!==t.priceFormat&&(this.Nh(),this.jt().Vh()),t.pane&&n!==t.pane&&this.jt().Bh(this,n,t.pane),this.jt().Fh(this),this.jt().zh(),this.Ki.dt("options")}Z(t,i){this.Nt.Z(t),this.Wh(),this.Ki.dt("data"),this.$i.dt("data"),null!==this.Th&&(i&&i.jh?this.Th.He():0===t.length&&this.Th.$e());const s=this.jt().me(this);this.jt().$h(s),this.jt().Fh(this),this.jt().zh(),this.jt().Hr()}Hh(t){this.Ph=t,this.Wh();const i=this.jt().me(this);this.$i.dt("data"),this.jt().$h(i),this.jt().Fh(this),this.jt().zh(),this.jt().Hr()}Uh(){return this.Ph}cr(){return this.Dh}qh(t){const i=new di(this,t);return this.kh.push(i),this.jt().Fh(this),i}Yh(t){const i=this.kh.indexOf(t);-1!==i&&this.kh.splice(i,1),this.jt().Fh(this)}Xr(){return this.Oh}kt(){const t=this.Xh();return null===t?null:{Pt:t.Pt[3],Kh:t.rt}}Xh(){const t=this.jt().Mt().on();if(null===t)return null;const i=t.Ys();return this.Nt._h(i,1)}ds(){return this.Nt}dr(t){const i=this.Nt.sh(t);return null===i?null:"Bar"===this.Oh||"Candlestick"===this.Oh?{Rn:i.Pt[0],An:i.Pt[1],In:i.Pt[2],Ln:i.Pt[3]}:i.Pt[3]}Zh(t){const i=this.Th;return null!==i&&i.yt()?(null===this.Eh&&i.qe()&&(this.Eh=setTimeout((()=>{this.Eh=null,this.jt().Gh()}),0)),i.Ue(),[i]):[]}rs(){const t=[];this.Jh()||t.push(this.xh),t.push(this.Ki,this.Wr,this.$i);const i=this.kh.map((t=>t.Ur()));return t.push(...i),t}Ei(t){return[this.jr,...this.kh.map((t=>t.qr()))]}hs(t,i){if(i!==this.xi&&!this.Jh())return[];const s=[...this.Li];for(const t of this.kh)s.push(t.Yr());return s}Qh(t,i){if(void 0!==this.ji.autoscaleInfoProvider){const s=this.ji.autoscaleInfoProvider((()=>{const s=this.tl(t,i);return null===s?null:s.Nr()}));return _i.Rr(s)}return this.tl(t,i)}il(){return this.ji.priceFormat.minMove}sl(){return this.nl}os(){var t;this.Ki.dt(),this.$i.dt();for(const t of this.Li)t.dt();for(const t of this.kh)t.dt();this.Wr.dt(),this.xh.dt(),null===(t=this.Th)||void 0===t||t.dt()}Ct(){return h(super.Ct())}St(t){if(!(("Line"===this.Oh||"Area"===this.Oh||"Baseline"===this.Oh)&&this.ji.crosshairMarkerVisible))return null;const i=this.Nt.sh(t);if(null===i)return null;return{ht:i.Pt[3],nt:this.el(),Dt:this.rl(),xt:this.hl(t)}}vr(){return this.ji.title}yt(){return this.ji.visible}Jh(){return!Z(this.Ct().ll())}tl(t,i){if(!b(t)||!b(i)||this.Nt.wi())return null;const s="Line"===this.Oh||"Area"===this.Oh||"Baseline"===this.Oh||"Histogram"===this.Oh?[3]:[2,1],n=this.Nt.dh(t,i,s);let e=null!==n?new oi(n.Sh,n.yh):null;if("Histogram"===this.Xr()){const t=this.ji.base,i=new oi(t,t);e=null!==e?e.Es(i):i}return new _i(e,this.$i.ur())}el(){switch(this.Oh){case"Line":case"Area":case"Baseline":return this.ji.crosshairMarkerRadius}return 0}rl(){switch(this.Oh){case"Line":case"Area":case"Baseline":{const t=this.ji.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}hl(t){switch(this.Oh){case"Line":case"Area":case"Baseline":{const t=this.ji.crosshairMarkerBackgroundColor;if(0!==t.length)return t}}return this.pn().Bn(t).Vn}Nh(){switch(this.ji.priceFormat.type){case"custom":this.nl={format:this.ji.priceFormat.formatter};break;case"volume":this.nl=new st(this.ji.priceFormat.precision);break;case"percent":this.nl=new it(this.ji.priceFormat.precision);break;default:{const t=Math.pow(10,this.ji.priceFormat.precision);this.nl=new tt(t,this.ji.priceFormat.minMove*t)}}null!==this.xi&&this.xi.al()}Wh(){const t=this.jt().Mt();if(t.wi()||0===this.Nt._n())return void(this.Dh=[]);const i=h(this.Nt.lh());this.Dh=this.Ph.map(((s,n)=>{const e=h(t.ol(s.time,!0)),r=e<i?1:-1;return{time:h(this.Nt._h(e,r)).wn,position:s.position,shape:s.shape,color:s.color,id:s.id,internalId:n,text:s.text,size:s.size}}))}Rh(){switch(this.$i=new hi(this,this.jt()),this.Oh){case"Bar":this.Ki=new Mt(this,this.jt());break;case"Candlestick":this.Ki=new Ot(this,this.jt());break;case"Line":this.Ki=new Lt(this,this.jt());break;case"Area":this.Ki=new wt(this,this.jt());break;case"Baseline":this.Ki=new Dt(this,this.jt());break;case"Histogram":this.Ki=new It(this,this.jt());break;default:throw Error("Unknown chart style assigned: "+this.Oh)}}}class Si{constructor(t){this.ji=t}_l(t,i,s){let n=t;if(0===this.ji.mode)return n;const e=s.Ui(),r=e.kt();if(null===r)return n;const h=e.Tt(t,r),a=s.gt().filter((t=>t instanceof Mi)).reduce(((t,n)=>{if(s.we(n)||!n.yt())return t;const e=n.Ct(),r=n.ds();if(e.wi()||!r.Ze(i))return t;const h=r.sh(i);if(null===h)return t;const a=l(n.kt());return t.concat([e.Tt(h.Pt[3],a.Pt)])}),[]);if(0===a.length)return n;a.sort(((t,i)=>Math.abs(t-h)-Math.abs(i-h)));const o=a[0];return n=e.qi(o,r),n}}class yi{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,n,e){if(null===this.Nt)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r;const l=Math.ceil(this.Nt.Lt*i),a=Math.ceil(this.Nt.It*i);!function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(()=>{const n=h(this.Nt);if(n.ul){t.strokeStyle=n.cl,s(t,n.dl),t.beginPath();for(const s of n.fl){const n=Math.round(s.pl*i);t.moveTo(n,-r),t.lineTo(n,l+r)}t.stroke()}if(n.vl){t.strokeStyle=n.ml,s(t,n.wl),t.beginPath();for(const s of n.gl){const n=Math.round(s.pl*i);t.moveTo(-r,n),t.lineTo(a+r,n)}t.stroke()}}))}}class ki{constructor(t){this.zt=new yi,this.hi=!0,this.Ni=t}dt(){this.hi=!0}vt(t,i){if(this.hi){const s=this.Ni.jt().B().grid,n={Lt:t,It:i,vl:s.horzLines.visible,ul:s.vertLines.visible,ml:s.horzLines.color,cl:s.vertLines.color,wl:s.horzLines.style,dl:s.vertLines.style,gl:this.Ni.Ui().bl(),fl:this.Ni.jt().Mt().bl()||[]};this.zt.Z(n),this.hi=!1}return this.zt}}class xi{constructor(t){this.Ki=new ki(t)}Ur(){return this.Ki}}const Ti={Ml:4,Sl:1e-4};function Ci(t,i){const s=100*(t-i)/i;return i<0?-s:s}function Pi(t,i){const s=Ci(t.Cr(),i),n=Ci(t.Pr(),i);return new oi(s,n)}function Di(t,i){const s=100*(t-i)/i+100;return i<0?-s:s}function Ei(t,i){const s=Di(t.Cr(),i),n=Di(t.Pr(),i);return new oi(s,n)}function Oi(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const n=kt(s+i.Sl)+i.Ml;return t<0?-n:n}function Ni(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const n=Math.pow(10,s-i.Ml)-i.Sl;return t<0?-n:n}function Ri(t,i){if(null===t)return null;const s=Oi(t.Cr(),i),n=Oi(t.Pr(),i);return new oi(s,n)}function Ai(t,i){if(null===t)return null;const s=Ni(t.Cr(),i),n=Ni(t.Pr(),i);return new oi(s,n)}function Ii(t){if(null===t)return Ti;const i=Math.abs(t.Pr()-t.Cr());if(i>=1||i<1e-15)return Ti;const s=Math.ceil(Math.abs(Math.log10(i))),n=Ti.Ml+s;return{Ml:n,Sl:1/Math.pow(10,n)}}class Li{constructor(t,i){if(this.yl=t,this.kl=i,function(t){if(t<0)return!1;for(let i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.yl))this.xl=[2,2.5,2];else{this.xl=[];for(let t=this.yl;1!==t;){if(t%2==0)this.xl.push(2),t/=2;else{if(t%5!=0)throw new Error("unexpected base");this.xl.push(2,2.5),t/=5}if(this.xl.length>100)throw new Error("something wrong with base")}}}Tl(t,i,s){const n=0===this.yl?0:1/this.yl;let e=Math.pow(10,Math.max(0,Math.ceil(kt(t-i)))),r=0,h=this.kl[0];for(;;){const t=yt(e,n,1e-14)&&e>n+1e-14,i=yt(e,s*h,1e-14),l=yt(e,1,1e-14);if(!(t&&i&&l))break;e/=h,h=this.kl[++r%this.kl.length]}if(e<=n+1e-14&&(e=n),e=Math.max(1,e),this.xl.length>0&&(l=e,a=1,o=1e-14,Math.abs(l-a)<o))for(r=0,h=this.xl[0];yt(e,s*h,1e-14)&&e>n+1e-14;)e/=h,h=this.xl[++r%this.xl.length];var l,a,o;return e}}class Vi{constructor(t,i,s,n){this.Cl=[],this.vi=t,this.yl=i,this.Pl=s,this.Dl=n}Tl(t,i){if(t<i)throw new Error("high < low");const s=this.vi.Yt(),n=(t-i)*this.El()/s,e=new Li(this.yl,[2,2.5,2]),r=new Li(this.yl,[2,2,2.5]),h=new Li(this.yl,[2.5,2,2]),l=[];return l.push(e.Tl(t,i,n),r.Tl(t,i,n),h.Tl(t,i,n)),function(t){if(t.length<1)throw Error("array is empty");let i=t[0];for(let s=1;s<t.length;++s)t[s]<i&&(i=t[s]);return i}(l)}Ol(){const t=this.vi,i=t.kt();if(null===i)return void(this.Cl=[]);const s=t.Yt(),n=this.Pl(s-1,i),e=this.Pl(0,i),r=this.vi.B().entireTextOnly?this.Nl()/2:0,h=r,l=s-1-r,a=Math.max(n,e),o=Math.min(n,e);if(a===o)return void(this.Cl=[]);let _=this.Tl(a,o),u=a%_;u+=u<0?_:0;const c=a>=o?1:-1;let d=null,f=0;for(let s=a-u;s>o;s-=_){const n=this.Dl(s,i,!0);null!==d&&Math.abs(n-d)<this.El()||(n<h||n>l||(f<this.Cl.length?(this.Cl[f].pl=n,this.Cl[f].Rl=t.Al(s)):this.Cl.push({pl:n,Rl:t.Al(s)}),f++,d=n,t.Il()&&(_=this.Tl(s*c,o))))}this.Cl.length=f}bl(){return this.Cl}Nl(){return this.vi.C()}El(){return Math.ceil(2.5*this.Nl())}}function Bi(t){return t.slice().sort(((t,i)=>h(t.Ci())-h(i.Ci())))}var Fi;!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(Fi||(Fi={}));const zi=new it,Wi=new tt(100,1);class ji{constructor(t,i,s,n){this.Ll=0,this.Vl=null,this.Ar=null,this.Bl=null,this.Fl={zl:!1,Wl:null},this.jl=0,this.$l=0,this.Hl=new m,this.Ul=new m,this.ql=[],this.Yl=null,this.Xl=null,this.Kl=null,this.Zl=null,this.nl=Wi,this.Gl=Ii(null),this.Jl=t,this.ji=i,this.Ql=s,this.ta=n,this.ia=new Vi(this,100,this.sa.bind(this),this.na.bind(this))}ll(){return this.Jl}B(){return this.ji}$r(t){if(w(this.ji,t),this.al(),void 0!==t.mode&&this.ea({xe:t.mode}),void 0!==t.scaleMargins){const i=r(t.scaleMargins.top),s=r(t.scaleMargins.bottom);if(i<0||i>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${i}`);if(s<0||s>1||i+s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(i+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${i+s}`);this.ra(),this.Xl=null}}ha(){return this.ji.autoScale}Il(){return 1===this.ji.mode}gr(){return 2===this.ji.mode}la(){return 3===this.ji.mode}xe(){return{bs:this.ji.autoScale,aa:this.ji.invertScale,xe:this.ji.mode}}ea(t){const i=this.xe();let s=null;void 0!==t.bs&&(this.ji.autoScale=t.bs),void 0!==t.xe&&(this.ji.mode=t.xe,2!==t.xe&&3!==t.xe||(this.ji.autoScale=!0),this.Fl.zl=!1),1===i.xe&&t.xe!==i.xe&&(!function(t,i){if(null===t)return!1;const s=Ni(t.Cr(),i),n=Ni(t.Pr(),i);return isFinite(s)&&isFinite(n)}(this.Ar,this.Gl)?this.ji.autoScale=!0:(s=Ai(this.Ar,this.Gl),null!==s&&this.oa(s))),1===t.xe&&t.xe!==i.xe&&(s=Ri(this.Ar,this.Gl),null!==s&&this.oa(s));const n=i.xe!==this.ji.mode;n&&(2===i.xe||this.gr())&&this.al(),n&&(3===i.xe||this.la())&&this.al(),void 0!==t.aa&&i.aa!==t.aa&&(this.ji.invertScale=t.aa,this._a()),this.Ul.m(i,this.xe())}ua(){return this.Ul}C(){return this.Ql.fontSize}Yt(){return this.Ll}ca(t){this.Ll!==t&&(this.Ll=t,this.ra(),this.Xl=null)}da(){if(this.Vl)return this.Vl;const t=this.Yt()-this.fa()-this.pa();return this.Vl=t,t}Lr(){return this.va(),this.Ar}oa(t,i){const s=this.Ar;(i||null===s&&null!==t||null!==s&&!s.kr(t))&&(this.Xl=null,this.Ar=t)}wi(){return this.va(),0===this.Ll||!this.Ar||this.Ar.wi()}ma(t){return this.aa()?t:this.Yt()-1-t}Tt(t,i){return this.gr()?t=Ci(t,i):this.la()&&(t=Di(t,i)),this.na(t,i)}dn(t,i,s){this.va();const n=this.pa(),e=h(this.Lr()),r=e.Cr(),l=e.Pr(),a=this.da()-1,o=this.aa(),_=a/(l-r),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.wa();for(let s=u;s<c;s++){const e=t[s],h=e.ht;if(isNaN(h))continue;let l=h;null!==d&&(l=d(e.ht,i));const a=n+_*(l-r),u=o?a:this.Ll-1-a;e.it=u}}On(t,i,s){this.va();const n=this.pa(),e=h(this.Lr()),r=e.Cr(),l=e.Pr(),a=this.da()-1,o=this.aa(),_=a/(l-r),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.wa();for(let s=u;s<c;s++){const e=t[s];let h=e.Rn,l=e.An,a=e.In,u=e.Ln;null!==d&&(h=d(e.Rn,i),l=d(e.An,i),a=d(e.In,i),u=d(e.Ln,i));let c=n+_*(h-r),f=o?c:this.Ll-1-c;e.Dn=f,c=n+_*(l-r),f=o?c:this.Ll-1-c,e.Tn=f,c=n+_*(a-r),f=o?c:this.Ll-1-c,e.Cn=f,c=n+_*(u-r),f=o?c:this.Ll-1-c,e.En=f}}qi(t,i){const s=this.sa(t,i);return this.ga(s,i)}ga(t,i){let s=t;return this.gr()?s=function(t,i){return i<0&&(t=-t),t/100*i+i}(s,i):this.la()&&(s=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(s,i)),s}gt(){return this.ql}ba(){if(this.Yl)return this.Yl;let t=[];for(let i=0;i<this.ql.length;i++){const s=this.ql[i];null===s.Ci()&&s.Pi(i+1),t.push(s)}return t=Bi(t),this.Yl=t,this.Yl}Ma(t){-1===this.ql.indexOf(t)&&(this.ql.push(t),this.al(),this.Sa())}ya(t){const i=this.ql.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.ql.splice(i,1),0===this.ql.length&&(this.ea({bs:!0}),this.oa(null)),this.al(),this.Sa()}kt(){let t=null;for(const i of this.ql){const s=i.kt();null!==s&&((null===t||s.Kh<t.Kh)&&(t=s))}return null===t?null:t.Pt}aa(){return this.ji.invertScale}bl(){const t=null===this.kt();if(null!==this.Xl&&(t||this.Xl.ka===t))return this.Xl.bl;this.ia.Ol();const i=this.ia.bl();return this.Xl={bl:i,ka:t},this.Hl.m(),i}xa(){return this.Hl}Ta(t){this.gr()||this.la()||null===this.Kl&&null===this.Bl&&(this.wi()||(this.Kl=this.Ll-t,this.Bl=h(this.Lr()).Tr()))}Ca(t){if(this.gr()||this.la())return;if(null===this.Kl)return;this.ea({bs:!1}),(t=this.Ll-t)<0&&(t=0);let i=(this.Kl+.2*(this.Ll-1))/(t+.2*(this.Ll-1));const s=h(this.Bl).Tr();i=Math.max(i,.1),s.Er(i),this.oa(s)}Pa(){this.gr()||this.la()||(this.Kl=null,this.Bl=null)}Da(t){this.ha()||null===this.Zl&&null===this.Bl&&(this.wi()||(this.Zl=t,this.Bl=h(this.Lr()).Tr()))}Ea(t){if(this.ha())return;if(null===this.Zl)return;const i=h(this.Lr()).Dr()/(this.da()-1);let s=t-this.Zl;this.aa()&&(s*=-1);const n=s*i,e=h(this.Bl).Tr();e.Or(n),this.oa(e,!0),this.Xl=null}Oa(){this.ha()||null!==this.Zl&&(this.Zl=null,this.Bl=null)}sl(){return this.nl||this.al(),this.nl}gi(t,i){switch(this.ji.mode){case 2:return this.sl().format(Ci(t,i));case 3:return this.sl().format(Di(t,i));default:return this.zr(t)}}Al(t){switch(this.ji.mode){case 2:case 3:return this.sl().format(t);default:return this.zr(t)}}Ah(t){return this.zr(t,h(this.Na()).sl())}Ih(t,i){return t=Ci(t,i),zi.format(t)}Ra(){return this.ql}Aa(t){this.Fl={Wl:t,zl:!1}}os(){this.ql.forEach((t=>t.os()))}al(){this.Xl=null;const t=this.Na();let i=100;null!==t&&(i=Math.round(1/t.il())),this.nl=Wi,this.gr()?(this.nl=zi,i=100):this.la()?(this.nl=new tt(100,1),i=100):null!==t&&(this.nl=t.sl()),this.ia=new Vi(this,i,this.sa.bind(this),this.na.bind(this)),this.ia.Ol()}Sa(){this.Yl=null}Na(){return this.ql[0]||null}fa(){return this.aa()?this.ji.scaleMargins.bottom*this.Yt()+this.$l:this.ji.scaleMargins.top*this.Yt()+this.jl}pa(){return this.aa()?this.ji.scaleMargins.top*this.Yt()+this.jl:this.ji.scaleMargins.bottom*this.Yt()+this.$l}va(){this.Fl.zl||(this.Fl.zl=!0,this.Ia())}ra(){this.Vl=null}na(t,i){if(this.va(),this.wi())return 0;t=this.Il()&&t?Oi(t,this.Gl):t;const s=h(this.Lr()),n=this.pa()+(this.da()-1)*(t-s.Cr())/s.Dr();return this.ma(n)}sa(t,i){if(this.va(),this.wi())return 0;const s=this.ma(t),n=h(this.Lr()),e=n.Cr()+n.Dr()*((s-this.pa())/(this.da()-1));return this.Il()?Ni(e,this.Gl):e}_a(){this.Xl=null,this.ia.Ol()}Ia(){const t=this.Fl.Wl;if(null===t)return;let i=null;const s=this.Ra();let n=0,e=0;for(const r of s){if(!r.yt())continue;const s=r.kt();if(null===s)continue;const l=r.Qh(t.Ys(),t.Xs());let a=l&&l.Lr();if(null!==a){switch(this.ji.mode){case 1:a=Ri(a,this.Gl);break;case 2:a=Pi(a,s.Pt);break;case 3:a=Ei(a,s.Pt)}if(i=null===i?a:i.Es(h(a)),null!==l){const t=l.Vr();null!==t&&(n=Math.max(n,t.above),e=Math.max(n,t.below))}}}if(n===this.jl&&e===this.$l||(this.jl=n,this.$l=e,this.Xl=null,this.ra()),null!==i){if(i.Cr()===i.Pr()){const t=this.Na(),s=5*(null===t||this.gr()||this.la()?1:t.il());this.Il()&&(i=Ai(i,this.Gl)),i=new oi(i.Cr()-s,i.Pr()+s),this.Il()&&(i=Ri(i,this.Gl))}if(this.Il()){const t=Ai(i,this.Gl),s=Ii(t);if(r=s,l=this.Gl,r.Ml!==l.Ml||r.Sl!==l.Sl){const n=null!==this.Bl?Ai(this.Bl,this.Gl):null;this.Gl=s,i=Ri(t,s),null!==n&&(this.Bl=Ri(n,s))}}this.oa(i)}else null===this.Ar&&(this.oa(new oi(-.5,.5)),this.Gl=Ii(null));var r,l;this.Fl.zl=!0}wa(){return this.gr()?Ci:this.la()?Di:this.Il()?t=>Oi(t,this.Gl):null}zr(t,i){return void 0===this.ta.priceFormatter?(void 0===i&&(i=this.sl()),i.format(t)):this.ta.priceFormatter(t)}}class $i{constructor(t,i,s=0){this.ql=[],this.La=new Map,this.Ll=0,this.ce=0,this.Va=1e3,this.Yl=null,this.Ba=new m,this.Fa=t,this.Si=i,this.za=new xi(this);const n=i.B();this.Wa=this.ja("left",n.leftPriceScale),this.$a=0===s?this.ja("right",n.rightPriceScale):this.ja("non-primary",n.nonPrimaryPriceScale),this.Wa.ua().l(this.Ha.bind(this,this.Wa),this),this.$a.ua().l(this.Ha.bind(this,this.$a),this),this.Ua(n)}Ua(t){if(t.leftPriceScale&&this.Wa.$r(t.leftPriceScale),"right"===this.$a.ll()&&t.rightPriceScale&&this.$a.$r(t.rightPriceScale),"non-primary"===this.$a.ll()&&t.nonPrimaryPriceScale&&this.$a.$r(t.nonPrimaryPriceScale),t.localization&&(this.Wa.al(),this.$a.al()),t.overlayPriceScales){const i=Array.from(this.La.values());for(const s of i){const i=h(s[0].Ct());i.$r(t.overlayPriceScales),t.localization&&i.al()}}}qa(t){switch(t){case"left":return this.Wa;case"right":return this.$a}return this.La.has(t)?r(this.La.get(t))[0].Ct():null}M(){this.jt().Ya().v(this),this.Wa.ua().v(this),this.$a.ua().v(this),this.ql.forEach((t=>{t.M&&t.M()})),this.Ba.m()}Xa(){return this.Va}Ka(t){this.Va=t}jt(){return this.Si}qt(){return this.ce}Yt(){return this.Ll}Za(t){this.ce=t,this.Ga()}ca(t){this.Ll=t,this.Wa.ca(t),this.$a.ca(t),this.ql.forEach((i=>{if(this.we(i)){const s=i.Ct();null!==s&&s.ca(t)}})),this.Ga()}gt(){return this.ql}we(t){const i=t.Ct();return null===i||this.Wa!==i&&this.$a!==i}Ma(t,i,s){const n=void 0!==s?s:this.Qa().Ja+1;this.io(t,i,n)}ya(t){const i=this.ql.indexOf(t);e(-1!==i,"removeDataSource: invalid data source"),this.ql.splice(i,1);const s=h(t.Ct()).ll();if(this.La.has(s)){const i=r(this.La.get(s)),n=i.indexOf(t);-1!==n&&(i.splice(n,1),0===i.length&&this.La.delete(s))}const n=t.Ct();n&&n.gt().indexOf(t)>=0&&n.ya(t),null!==n&&(n.Sa(),this.so(n)),this.Yl=null}be(t){return t===this.Wa?"left":t===this.$a?"right":"overlay"}no(){return this.Wa}eo(){return this.$a}ro(t,i){t.Ta(i)}ho(t,i){t.Ca(i),this.Ga()}lo(t){t.Pa()}ao(t,i){t.Da(i)}oo(t,i){t.Ea(i),this.Ga()}_o(t){t.Oa()}Ga(){this.ql.forEach((t=>{t.os()}))}Ui(){let t=null;return this.Si.B().rightPriceScale.visible&&0!==this.$a.gt().length?t=this.$a:this.Si.B().leftPriceScale.visible&&0!==this.Wa.gt().length?t=this.Wa:0!==this.ql.length&&(t=this.ql[0].Ct()),null===t&&(t=this.$a),t}ge(){let t=null;return this.Si.B().rightPriceScale.visible?t=this.$a:this.Si.B().leftPriceScale.visible&&(t=this.Wa),t}so(t){null!==t&&t.ha()&&this.uo(t)}co(t){const i=this.Fa.on();t.ea({bs:!0}),null!==i&&t.Aa(i),this.Ga()}do(){this.uo(this.Wa),this.uo(this.$a)}fo(){this.so(this.Wa),this.so(this.$a),this.ql.forEach((t=>{this.we(t)&&this.so(t.Ct())})),this.Ga(),this.Si.Hr()}ba(){return null===this.Yl&&(this.Yl=Bi(this.ql)),this.Yl}po(){return this.Ba}vo(){return this.za}uo(t){const i=t.Ra();if(i&&i.length>0&&!this.Fa.wi()){const i=this.Fa.on();null!==i&&t.Aa(i)}t.os()}Qa(){const t=this.ba();if(0===t.length)return{mo:0,Ja:0};let i=0,s=0;for(let n=0;n<t.length;n++){const e=t[n].Ci();null!==e&&(e<i&&(i=e),e>s&&(s=e))}return{mo:i,Ja:s}}io(t,i,s){let n=this.qa(i);if(null===n&&(n=this.ja(i,this.Si.B().overlayPriceScales)),this.ql.push(t),!Z(i)){const s=this.La.get(i)||[];s.push(t),this.La.set(i,s)}n.Ma(t),t.Di(n),t.Pi(s),this.so(n),this.Yl=null}Ha(t,i,s){i.xe!==s.xe&&this.uo(t)}ja(t,i){const s=Object.assign({visible:!0,autoScale:!0},y(i)),n=new ji(t,s,this.Si.B().layout,this.Si.B().localization);return n.ca(this.Yt()),n}}const Hi=t=>t.getUTCFullYear();function Ui(t,i,s){return i.replace(/yyyy/g,(t=>Q(Hi(t),4))(t)).replace(/yy/g,(t=>Q(Hi(t)%100,2))(t)).replace(/MMMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"}))(t,s)).replace(/MMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"}))(t,s)).replace(/MM/g,(t=>Q((t=>t.getUTCMonth()+1)(t),2))(t)).replace(/dd/g,(t=>Q((t=>t.getUTCDate())(t),2))(t))}class qi{constructor(t="yyyy-MM-dd",i="default"){this.wo=t,this.bo=i}Mo(t){return Ui(t,this.wo,this.bo)}}class Yi{constructor(t){this.So=t||"%h:%m:%s"}Mo(t){return this.So.replace("%h",Q(t.getUTCHours(),2)).replace("%m",Q(t.getUTCMinutes(),2)).replace("%s",Q(t.getUTCSeconds(),2))}}const Xi={yo:"yyyy-MM-dd",ko:"%h:%m:%s",xo:" ",To:"default"};class Ki{constructor(t={}){const i=Object.assign(Object.assign({},Xi),t);this.Co=new qi(i.yo,i.To),this.Po=new Yi(i.ko),this.Do=i.xo}Mo(t){return`${this.Co.Mo(t)}${this.Do}${this.Po.Mo(t)}`}}class Zi{constructor(t,i=50){this.Eo=0,this.Oo=1,this.No=1,this.he=new Map,this.Ro=new Map,this.Ao=t,this.Io=i}Mo(t){const i=t.rt,s=void 0===i.Lo?new Date(1e3*i.Vo).getTime():new Date(Date.UTC(i.Lo.year,i.Lo.month-1,i.Lo.day)).getTime(),n=this.he.get(s);if(void 0!==n)return n.Bo;if(this.Eo===this.Io){const t=this.Ro.get(this.No);this.Ro.delete(this.No),this.he.delete(r(t)),this.No++,this.Eo--}const e=this.Ao(t);return this.he.set(s,{Bo:e,Fo:this.Oo}),this.Ro.set(this.Oo,s),this.Eo++,this.Oo++,e}}class Gi{constructor(t,i){e(t<=i,"right should be >= left"),this.zo=t,this.Wo=i}Ys(){return this.zo}Xs(){return this.Wo}jo(){return this.Wo-this.zo+1}Ze(t){return this.zo<=t&&t<=this.Wo}kr(t){return this.zo===t.Ys()&&this.Wo===t.Xs()}}function Ji(t,i){return null===t||null===i?t===i:t.kr(i)}class Qi{constructor(){this.$o=new Map,this.he=null}Ho(t,i){this.Uo(i),this.he=null;for(let s=i;s<t.length;++s){const i=t[s];let n=this.$o.get(i.qo);void 0===n&&(n=[],this.$o.set(i.qo,n)),n.push({wn:s,rt:i.rt,Yo:i.qo,Xo:i.Xo})}}Ko(t,i){const s=Math.ceil(i/t);return null!==this.he&&this.he.Zo===s||(this.he={bl:this.Go(s),Zo:s}),this.he.bl}Uo(t){if(0===t)return void this.$o.clear();const i=[];this.$o.forEach(((s,n)=>{t<=s[0].wn?i.push(n):s.splice(ut(s,t,(i=>i.wn<t)),1/0)}));for(const t of i)this.$o.delete(t)}Go(t){let i=[];for(const s of Array.from(this.$o.keys()).sort(((t,i)=>i-t))){if(!this.$o.get(s))continue;const n=i;i=[];const e=n.length;let h=0;const l=r(this.$o.get(s)),a=l.length;let o=1/0,_=-1/0;for(let s=0;s<a;s++){const r=l[s],a=r.wn;for(;h<e;){const t=n[h],s=t.wn;if(!(s<a)){o=s;break}h++,i.push(t),_=s,o=1/0}o-a>=t&&a-_>=t&&(i.push(r),_=a)}for(;h<e;h++)i.push(n[h])}return i}}class ts{constructor(t){this.Jo=t}Qo(){return null===this.Jo?null:new Gi(Math.floor(this.Jo.Ys()),Math.ceil(this.Jo.Xs()))}t_(){return this.Jo}static i_(){return new ts(null)}}var is,ss,ns,es,rs;!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(is||(is={}));class hs{constructor(t,i,s){this.ce=0,this.s_=null,this.n_=[],this.Zl=null,this.Kl=null,this.e_=new Qi,this.r_=new Map,this.h_=ts.i_(),this.l_=!0,this.a_=new m,this.o_=new m,this.__=new m,this.u_=null,this.c_=null,this.d_=[],this.ji=i,this.ta=s,this.f_=i.rightOffset,this.p_=i.barSpacing,this.Si=t,this.v_()}B(){return this.ji}m_(t){w(this.ta,t),this.w_(),this.v_()}$r(t,i){var s;w(this.ji,t),this.ji.fixLeftEdge&&this.g_(),this.ji.fixRightEdge&&this.b_(),void 0!==t.barSpacing&&this.Si.Cs(t.barSpacing),void 0!==t.rightOffset&&this.Si.Ps(t.rightOffset),void 0!==t.minBarSpacing&&this.Si.Cs(null!==(s=t.barSpacing)&&void 0!==s?s:this.p_),this.w_(),this.v_(),this.__.m()}Yi(t){var i,s;return null!==(s=null===(i=this.n_[t])||void 0===i?void 0:i.rt)&&void 0!==s?s:null}yi(t){var i;return null!==(i=this.n_[t])&&void 0!==i?i:null}ol(t,i){if(this.n_.length<1)return null;if(t.Vo>this.n_[this.n_.length-1].rt.Vo)return i?this.n_.length-1:null;const s=ut(this.n_,t.Vo,((t,i)=>t.rt.Vo<i));return t.Vo<this.n_[s].rt.Vo?i?s:null:s}wi(){return 0===this.ce||0===this.n_.length||null===this.s_}on(){return this.M_(),this.h_.Qo()}S_(){return this.M_(),this.h_.t_()}y_(){const t=this.on();if(null===t)return null;const i={from:t.Ys(),to:t.Xs()};return this.k_(i)}k_(t){const i=Math.round(t.from),s=Math.round(t.to),n=h(this.x_()),e=h(this.T_());return{from:h(this.Yi(Math.max(n,i))),to:h(this.Yi(Math.min(e,s)))}}C_(t){return{from:h(this.ol(t.from,!0)),to:h(this.ol(t.to,!0))}}qt(){return this.ce}Za(t){if(!isFinite(t)||t<=0)return;if(this.ce===t)return;const i=this.S_(),s=this.ce;if(this.ce=t,this.l_=!0,this.ji.lockVisibleTimeRangeOnResize&&0!==s){const i=this.p_*t/s;this.p_=i}if(this.ji.fixLeftEdge&&null!==i&&i.Ys()<=0){const i=s-t;this.f_-=Math.round(i/this.p_)+1,this.l_=!0}this.P_(),this.D_()}Ot(t){if(this.wi()||!b(t))return 0;const i=this.E_()+this.f_-t;return this.ce-(i+.5)*this.p_-1}cn(t,i){const s=this.E_(),n=void 0===i?0:i.from,e=void 0===i?t.length:i.to;for(let i=n;i<e;i++){const n=t[i].rt,e=s+this.f_-n,r=this.ce-(e+.5)*this.p_-1;t[i].tt=r}}O_(t){return Math.ceil(this.N_(t))}Ps(t){this.l_=!0,this.f_=t,this.D_(),this.Si.R_(),this.Si.Hr()}Mn(){return this.p_}Cs(t){this.A_(t),this.D_(),this.Si.R_(),this.Si.Hr()}I_(){return this.f_}bl(){if(this.wi())return null;if(null!==this.c_)return this.c_;const t=this.p_,i=5*(this.Si.B().layout.fontSize+4),s=Math.round(i/t),n=h(this.on()),e=Math.max(n.Ys(),n.Ys()-s),r=Math.max(n.Xs(),n.Xs()-s),l=this.e_.Ko(t,i),a=this.x_()+s,o=this.T_()-s,_=this.L_(),u=this.ji.fixLeftEdge||_,c=this.ji.fixRightEdge||_;let d=0;for(const t of l){if(!(e<=t.wn&&t.wn<=r))continue;let s;d<this.d_.length?(s=this.d_[d],s.pl=this.Ot(t.wn),s.Rl=this.V_(t),s.Yo=t.Yo):(s={B_:!1,pl:this.Ot(t.wn),Rl:this.V_(t),Yo:t.Yo},this.d_.push(s)),this.p_>i/2&&!_?s.B_=!1:s.B_=u&&t.wn<=a||c&&t.wn>=o,d++}return this.d_.length=d,this.c_=this.d_,this.d_}F_(){this.l_=!0,this.Cs(this.ji.barSpacing),this.Ps(this.ji.rightOffset)}z_(t){this.l_=!0,this.s_=t,this.D_(),this.g_()}W_(t,i){const s=this.N_(t),n=this.Mn(),e=n+i*(n/10);this.Cs(e),this.ji.rightBarStaysOnScroll||this.Ps(this.I_()+(s-this.N_(t)))}Ta(t){this.Zl&&this.Oa(),null===this.Kl&&null===this.u_&&(this.wi()||(this.Kl=t,this.j_()))}Ca(t){if(null===this.u_)return;const i=St(this.ce-t,0,this.ce),s=St(this.ce-h(this.Kl),0,this.ce);0!==i&&0!==s&&this.Cs(this.u_.Mn*i/s)}Pa(){null!==this.Kl&&(this.Kl=null,this.H_())}Da(t){null===this.Zl&&null===this.u_&&(this.wi()||(this.Zl=t,this.j_()))}Ea(t){if(null===this.Zl)return;const i=(this.Zl-t)/this.Mn();this.f_=h(this.u_).I_+i,this.l_=!0,this.D_()}Oa(){null!==this.Zl&&(this.Zl=null,this.H_())}U_(){this.q_(this.ji.rightOffset)}q_(t,i=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.f_,n=performance.now(),e=()=>{const r=(performance.now()-n)/i,h=r>=1,l=h?t:s+(t-s)*r;this.Ps(l),h||setTimeout(e,20)};e()}dt(t,i){this.l_=!0,this.n_=t,this.e_.Ho(t,i),this.D_()}Y_(){return this.a_}X_(){return this.o_}K_(){return this.__}E_(){return this.s_||0}Z_(t){const i=t.jo();this.A_(this.ce/i),this.f_=t.Xs()-this.E_(),this.D_(),this.l_=!0,this.Si.R_(),this.Si.Hr()}G_(){const t=this.x_(),i=this.T_();null!==t&&null!==i&&this.Z_(new Gi(t,i+this.ji.rightOffset))}J_(t){const i=new Gi(t.from,t.to);this.Z_(i)}ki(t){return void 0!==this.ta.timeFormatter?this.ta.timeFormatter(t.Xo):this.Q_.Mo(new Date(1e3*t.rt.Vo))}L_(){const{handleScroll:t,handleScale:i}=this.Si.B();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||i.axisDoubleClickReset||i.axisPressedMouseMove.time||i.mouseWheel||i.pinch)}x_(){return 0===this.n_.length?null:0}T_(){return 0===this.n_.length?null:this.n_.length-1}tu(t){return(this.ce-1-t)/this.p_}N_(t){const i=this.tu(t),s=this.E_()+this.f_-i;return Math.round(1e6*s)/1e6}A_(t){const i=this.p_;this.p_=t,this.P_(),i!==this.p_&&(this.l_=!0,this.iu())}M_(){if(!this.l_)return;if(this.l_=!1,this.wi())return void this.su(ts.i_());const t=this.E_(),i=this.ce/this.p_,s=this.f_+t,n=new Gi(s-i+1,s);this.su(new ts(n))}P_(){const t=this.nu();if(this.p_<t&&(this.p_=t,this.l_=!0),0!==this.ce){const t=.5*this.ce;this.p_>t&&(this.p_=t,this.l_=!0)}}nu(){return this.ji.fixLeftEdge&&this.ji.fixRightEdge&&0!==this.n_.length?this.ce/this.n_.length:this.ji.minBarSpacing}D_(){const t=this.eu();this.f_>t&&(this.f_=t,this.l_=!0);const i=this.ru();null!==i&&this.f_<i&&(this.f_=i,this.l_=!0)}ru(){const t=this.x_(),i=this.s_;if(null===t||null===i)return null;return t-i-1+(this.ji.fixLeftEdge?this.ce/this.p_:Math.min(2,this.n_.length))}eu(){return this.ji.fixRightEdge?0:this.ce/this.p_-Math.min(2,this.n_.length)}j_(){this.u_={Mn:this.Mn(),I_:this.I_()}}H_(){this.u_=null}V_(t){let i=this.r_.get(t.Yo);return void 0===i&&(i=new Zi((t=>this.hu(t))),this.r_.set(t.Yo,i)),i.Mo(t)}hu(t){const i=function(t,i,s){switch(t){case 0:case 10:return i?s?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.Yo,this.ji.timeVisible,this.ji.secondsVisible);return void 0!==this.ji.tickMarkFormatter?this.ji.tickMarkFormatter(t.Xo,i,this.ta.locale):function(t,i,s){const n={};switch(i){case 0:n.year="numeric";break;case 1:n.month="short";break;case 2:n.day="numeric";break;case 3:n.hour12=!1,n.hour="2-digit",n.minute="2-digit";break;case 4:n.hour12=!1,n.hour="2-digit",n.minute="2-digit",n.second="2-digit"}const e=void 0===t.Lo?new Date(1e3*t.Vo):new Date(Date.UTC(t.Lo.year,t.Lo.month-1,t.Lo.day));return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()).toLocaleString(s,n)}(t.rt,i,this.ta.locale)}su(t){const i=this.h_;this.h_=t,Ji(i.Qo(),this.h_.Qo())||this.a_.m(),Ji(i.t_(),this.h_.t_())||this.o_.m(),this.iu()}iu(){this.c_=null}w_(){this.iu(),this.r_.clear()}v_(){const t=this.ta.dateFormat;this.ji.timeVisible?this.Q_=new Ki({yo:t,ko:this.ji.secondsVisible?"%h:%m:%s":"%h:%m",xo:"   ",To:this.ta.locale}):this.Q_=new qi(t,this.ta.locale)}g_(){if(!this.ji.fixLeftEdge)return;const t=this.x_();if(null===t)return;const i=this.on();if(null===i)return;const s=i.Ys()-t;if(s<0){const t=this.f_-s-1;this.Ps(t)}this.P_()}b_(){this.D_(),this.P_()}}class ls extends E{constructor(t){super(),this.lu=new Map,this.Nt=t}q(t){}X(t){if(!this.Nt.yt)return;t.save();let i=0;for(const s of this.Nt.au){if(0===s.Qt.length)continue;t.font=s.P;const n=this.ou(t,s.Qt);n>this.Nt.qt?s.W_=this.Nt.qt/n:s.W_=1,i+=s._u*s.W_}let s=0;switch(this.Nt.uu){case"top":s=0;break;case"center":s=Math.max((this.Nt.Yt-i)/2,0);break;case"bottom":s=Math.max(this.Nt.Yt-i,0)}t.fillStyle=this.Nt.O;for(const i of this.Nt.au){t.save();let n=0;switch(this.Nt.cu){case"left":t.textAlign="left",n=i._u/2;break;case"center":t.textAlign="center",n=this.Nt.qt/2;break;case"right":t.textAlign="right",n=this.Nt.qt-1-i._u/2}t.translate(n,s),t.textBaseline="top",t.font=i.P,t.scale(i.W_,i.W_),t.fillText(i.Qt,0,i.du),t.restore(),s+=i._u*i.W_}t.restore()}ou(t,i){const s=this.fu(t.font);let n=s.get(i);return void 0===n&&(n=t.measureText(i).width,s.set(i,n)),n}fu(t){let i=this.lu.get(t);return void 0===i&&(i=new Map,this.lu.set(t,i)),i}}class as{constructor(t){this.hi=!0,this.Ft={yt:!1,O:"",Yt:0,qt:0,au:[],uu:"center",cu:"center"},this.zt=new ls(this.Ft),this.Wt=t}dt(){this.hi=!0}vt(t,i){return this.hi&&(this.wt(t,i),this.hi=!1),this.zt}wt(t,i){const s=this.Wt.B(),n=this.Ft;n.yt=s.visible,n.yt&&(n.O=s.color,n.qt=i,n.Yt=t,n.cu=s.horzAlign,n.uu=s.vertAlign,n.au=[{Qt:s.text,P:C(s.fontSize,s.fontFamily,s.fontStyle),_u:1.2*s.fontSize,du:0,W_:0}])}}class os extends Y{constructor(t,i){super(),this.ji=i,this.Ki=new as(this)}hs(){return[]}rs(){return[this.Ki]}B(){return this.ji}os(){this.Ki.dt()}}!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(ss||(ss={}));class _s{constructor(t,i){this.pu=[],this.vu=new Map,this.mu=[],this.ce=0,this.wu=null,this.gu=null,this.bu=new m,this.Mu=new m,this.Su=!1,this.yu=null,this.ku=t,this.ji=i,this.xu=new P(this),this.Fa=new hs(this,i.timeScale,this.ji.localization),this.ct=new K(this,i.crosshair),this.Tu=new Si(i.crosshair),this.Cu=new os(this,i.watermark),this.Pu(),this.pu[0].Ka(2e3),this.Du=this.Eu(0),this.Ou=this.Eu(1)}Vh(){this.Nu(new G(3))}Hr(){this.Nu(new G(2))}Gh(){this.Nu(new G(1))}Fh(t){const i=this.Ru(t);this.Nu(i)}Au(){return this.gu}Iu(t){const i=this.gu;this.gu=t,null!==i&&this.Fh(i.Lu),null!==t&&this.Fh(t.Lu)}B(){return this.ji}$r(t){w(this.ji,t),this.pu.forEach((i=>i.Ua(t))),void 0!==t.timeScale&&this.Fa.$r(t.timeScale),void 0!==t.localization&&this.Fa.m_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.bu.m(),this.Du=this.Eu(0),this.Ou=this.Eu(1),this.Vh()}Vu(t,i){if("left"===t)return void this.$r({leftPriceScale:i});if("right"===t)return void this.$r({rightPriceScale:i});const s=this.Bu(t);null!==s&&(s.Ct.$r(i),this.bu.m())}Bu(t){for(const i of this.pu){const s=i.qa(t);if(null!==s)return{$t:i,Ct:s}}return null}Mt(){return this.Fa}Fu(){return this.pu}zu(){return this.Cu}Wu(){return this.ct}ju(){return this.Mu}$u(t,i){t.ca(i),this.R_()}Za(t){this.ce=t,this.Fa.Za(this.ce),this.pu.forEach((i=>i.Za(t))),this.R_()}Pu(t){if(void 0!==t)if(t>this.pu.length)for(let i=this.pu.length;i<t;i++)this.Pu(i);else if(t<this.pu.length)return this.pu[t];const i=void 0===t?this.pu.length-1+1:t,s=new $i(this.Fa,this,i);void 0!==t?this.pu.splice(t,0,s):this.pu.push(s),this.Hu();const n=new G(3);return n.ws(i,{gs:0,bs:!0}),this.Nu(n),s}Uu(t){if(0===t)return;if(this.pu[t].ba().forEach((t=>{t instanceof Mi&&this.qu(t)})),this.Su=!0,t!==this.pu.length-1)for(let i=t+1;i<this.pu.length;i++){this.pu[i].ba().forEach((t=>{t instanceof Mi&&t.$r({pane:i-1})}))}this.pu.splice(t,1),this.Su=!1,this.Hu();const i=new G(3);this.Nu(i)}Yu(t,i){const s=this.pu[t],n=this.pu[i];this.Su=!0,s.ba().forEach((t=>{t instanceof Mi&&t.$r({pane:i})})),n.ba().forEach((i=>{i instanceof Mi&&i.$r({pane:t})})),this.pu[t]=n,this.pu[i]=s,this.Su=!1,this.Hu(),this.Nu(new G(3))}ro(t,i,s){t.ro(i,s)}ho(t,i,s){t.ho(i,s),this.zh(),this.Nu(this.Xu(t,2))}lo(t,i){t.lo(i),this.Nu(this.Xu(t,2))}ao(t,i,s){i.ha()||t.ao(i,s)}oo(t,i,s){i.ha()||(t.oo(i,s),this.zh(),this.Nu(this.Xu(t,2)))}_o(t,i){i.ha()||(t._o(i),this.Nu(this.Xu(t,2)))}co(t,i){t.co(i),this.Nu(this.Xu(t,2))}Ku(t){this.Fa.Ta(t)}Zu(t,i){const s=this.Mt();if(s.wi()||0===i)return;const n=s.qt();t=Math.max(1,Math.min(t,n)),s.W_(t,i),this.R_()}Gu(t){this.Ju(0),this.Qu(t),this.tc()}ic(t){this.Fa.Ca(t),this.R_()}sc(){this.Fa.Pa(),this.Hr()}Ju(t){this.wu=t,this.Fa.Da(t)}Qu(t){let i=!1;return null!==this.wu&&Math.abs(t-this.wu)>20&&(this.wu=null,i=!0),this.Fa.Ea(t),this.R_(),i}tc(){this.Fa.Oa(),this.Hr(),this.wu=null}ft(){return this.mu}nc(t,i,s){this.ct.Zi(t,i);let n=NaN,e=this.Fa.O_(t);const r=this.Fa.on();null!==r&&(e=Math.min(Math.max(r.Ys(),e),r.Xs()));const h=s.Ui(),l=h.kt();null!==l&&(n=h.qi(i,l)),n=this.Tu._l(n,e,s),this.ct.ts(e,n,s),this.Gh();const a=this.ec(s);this.Mu.m(this.ct.bt(),{x:t,y:i,rc:a})}hc(){this.Wu().ns(),this.Gh(),this.Mu.m(null,null)}zh(){const t=this.ct.$t();if(null!==t){const i=this.ct.Ji(),s=this.ct.Qi();this.nc(i,s,t)}this.ct.os()}lc(t,i,s){const n=this.Fa.Yi(0);void 0!==i&&void 0!==s&&this.Fa.dt(i,s);const e=this.Fa.Yi(0),r=this.Fa.E_(),h=this.Fa.on();if(null!==h&&null!==n&&null!==e){const i=h.Ze(r),s=n.Vo>e.Vo,l=null!==t&&t>r&&!s,a=i&&this.Fa.B().shiftVisibleRangeOnNewBar;if(l&&!a){const i=t-r;this.Fa.Ps(this.Fa.I_()-i)}}this.Fa.z_(t)}$h(t){null!==t&&t.fo()}me(t){const i=this.pu.find((i=>i.ba().includes(t)));return void 0===i?null:i}R_(){this.Cu.os(),this.pu.forEach((t=>t.fo())),this.zh()}M(){this.pu.forEach((t=>t.M())),this.pu.length=0,this.ji.localization.priceFormatter=void 0,this.ji.localization.timeFormatter=void 0}ac(){return this.xu}Me(){return this.xu.B()}Ya(){return this.bu}oc(t,i){const s=i.pane||0;this.pu.length-1<=s&&this.Pu(s);const n=this.pu[s],e=this._c(i,t,n);return this.mu.push(e),1===this.mu.length?this.Vh():this.Hr(),e}qu(t){const i=this.me(t),s=this.mu.indexOf(t);e(-1!==s,"Series not found"),this.mu.splice(s,1),h(i).ya(t),t.M&&t.M()}Lh(t,i){const s=h(this.me(t));s.ya(t);const n=this.Bu(i);if(null===n){const n=t.Ci();s.Ma(t,i,n)}else{const e=n.$t===s?t.Ci():void 0;n.$t.Ma(t,i,e)}}G_(){const t=new G(2);t.ys(),this.Nu(t)}uc(t){const i=new G(2);i.xs(t),this.Nu(i)}Ts(){const t=new G(2);t.Ts(),this.Nu(t)}Cs(t){const i=new G(2);i.Cs(t),this.Nu(i)}Ps(t){const i=new G(2);i.Ps(t),this.Nu(i)}cc(){return this.ji.rightPriceScale.visible?"right":"left"}Bh(t,i,s){if(s===i||this.Su)return;t.B().pane!==s&&t.$r({pane:s});const n=this.me(t);null==n||n.ya(t);const e=this.Pu(s);this.dc(t,e)}fc(){return this.Ou}vc(){return this.Du}Et(t){const i=this.Ou,s=this.Du;if(i===s)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.yu||this.yu.$s!==s||this.yu.Hs!==i)this.yu={$s:s,Hs:i,mc:new Map};else{const i=this.yu.mc.get(t);if(void 0!==i)return i}const n=function(t,i,s){const[n,e,r,h]=p(t),[l,a,u,c]=p(i),d=[o(n+s*(l-n)),o(e+s*(a-e)),o(r+s*(u-r)),_(h+s*(c-h))];return`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`}(s,i,t/100);return this.yu.mc.set(t,n),n}ec(t){var i;return null!==(i=this.vu.get(t))&&void 0!==i?i:0}Xu(t,i){const s=new G(i);if(null!==t){const n=this.pu.indexOf(t);s.ws(n,{gs:i})}return s}Ru(t,i){return void 0===i&&(i=2),this.Xu(this.me(t),i)}Nu(t){this.ku&&this.ku(t),this.pu.forEach((t=>t.vo().Ur().dt()))}_c(t,i,s){const n=new Mi(this,t,i);return this.dc(n,s),n}dc(t,i){const s=t.B().priceScaleId,n=void 0!==s?s:this.cc();i.Ma(t,n),Z(n)||t.$r(t.B())}Eu(t){const i=this.ji.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color}Hu(){this.vu.clear();for(let t=0;t<this.pu.length;t++)this.vu.set(this.pu[t],t)}}function us(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function cs(t){return!g(t)&&!M(t)}function ds(t){return g(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}(ns||(ns={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(es||(es={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(rs||(rs={}));var fs={allowDownsampling:!0};var ps=function(){function t(t,i){var s=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(t){return s._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=i,this._configureCanvas(),this._installResolutionListener()}return t.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),t.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(t.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),t.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},t.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(i){return i!=t}))},t.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},t.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach((function(i){return i.call(t)}))},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");var i=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+i+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},t}();class vs{constructor(t,i){this.It=t,this.Lt=i}kr(t){return this.It===t.It&&this.Lt===t.Lt}}function ms(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function ws(t){const i=h(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function gs(t,i){const s=t.createElement("canvas"),n=ms(s);return s.style.width=`${i.It}px`,s.style.height=`${i.Lt}px`,s.width=i.It*n,s.height=i.Lt*n,s}function bs(t,i){const s=h(t.ownerDocument).createElement("canvas");t.appendChild(s);const n=function(t,i){return void 0===i&&(i=fs),new ps(t,i)}(s,{allowDownsampling:!1});return n.resizeCanvas({width:i.It,height:i.Lt}),n}const Ms="undefined"!=typeof window;function Ss(){return!!Ms&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function ys(){return!!Ms&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function ks(t){Ms&&void 0!==window.chrome&&t.addEventListener("mousedown",(t=>{if(1===t.button)return t.preventDefault(),!1}))}class xs{constructor(t,i,s){this.wc=0,this.gc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.Mc=0,this.Sc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.kc=null,this.xc=!1,this.Tc=null,this.Cc=null,this.Pc=!1,this.Dc=!1,this.Ec=!1,this.Oc=null,this.Nc=null,this.Rc=null,this.Ac=null,this.Ic=null,this.Lc=null,this.Vc=null,this.Bc=0,this.Fc=!1,this.zc=!1,this.Wc=!1,this.jc=0,this.$c=null,this.Hc=!ys(),this.Uc=t=>{this.qc(t)},this.Yc=t=>{if(this.Xc(t)){const i=this.Kc(t);if(++this.Mc,this.Sc&&this.Mc>1){const{Zc:s}=this.Gc(Ps(t),this.yc);s<30&&!this.Ec&&this.Jc(i,this.td.Qc),this.sd()}}else{const i=this.Kc(t);if(++this.wc,this.gc&&this.wc>1){const{Zc:s}=this.Gc(Ps(t),this.bc);s<5&&!this.Dc&&this.nd(i,this.td.ed),this.rd()}}},this.hd=t,this.td=i,this.ji=s,this.ld()}M(){null!==this.Oc&&(this.Oc(),this.Oc=null),null!==this.Nc&&(this.Nc(),this.Nc=null),null!==this.Ac&&(this.Ac(),this.Ac=null),null!==this.Ic&&(this.Ic(),this.Ic=null),null!==this.Lc&&(this.Lc(),this.Lc=null),null!==this.Rc&&(this.Rc(),this.Rc=null),this.ad(),this.rd()}od(t){this.Ac&&this.Ac();const i=this._d.bind(this);if(this.Ac=()=>{this.hd.removeEventListener("mousemove",i)},this.hd.addEventListener("mousemove",i),this.Xc(t))return;const s=this.Kc(t);this.nd(s,this.td.ud),this.Hc=!0}rd(){null!==this.gc&&clearTimeout(this.gc),this.wc=0,this.gc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}sd(){null!==this.Sc&&clearTimeout(this.Sc),this.Mc=0,this.Sc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}_d(t){if(this.Wc||null!==this.Cc)return;if(this.Xc(t))return;const i=this.Kc(t);this.nd(i,this.td.dd),this.Hc=!0}fd(t){const i=Es(t.changedTouches,h(this.$c));if(null===i)return;if(this.jc=Ds(t),null!==this.Vc)return;if(this.zc)return;this.Fc=!0;const s=this.Gc(Ps(i),h(this.Cc)),{pd:n,vd:e,Zc:r}=s;if(this.Pc||!(r<5)){if(!this.Pc){const t=.5*n,i=e>=t&&!this.ji.md(),s=t>e&&!this.ji.wd();i||s||(this.zc=!0),this.Pc=!0,this.Ec=!0,this.ad(),this.sd()}if(!this.zc){const s=this.Kc(t,i);this.Jc(s,this.td.gd),Cs(t)}}}bd(t){if(0!==t.button)return;const i=this.Gc(Ps(t),h(this.Tc)),{Zc:s}=i;if(s>=5&&(this.Dc=!0,this.rd()),this.Dc){const i=this.Kc(t);this.nd(i,this.td.Md)}}Gc(t,i){const s=Math.abs(i.tt-t.tt),n=Math.abs(i.it-t.it);return{pd:s,vd:n,Zc:s+n}}Sd(t){let i=Es(t.changedTouches,h(this.$c));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null===i)return;this.$c=null,this.jc=Ds(t),this.ad(),this.Cc=null,this.Lc&&(this.Lc(),this.Lc=null);const s=this.Kc(t,i);if(this.Jc(s,this.td.yd),++this.Mc,this.Sc&&this.Mc>1){const{Zc:t}=this.Gc(Ps(i),this.yc);t<30&&!this.Ec&&this.Jc(s,this.td.Qc),this.sd()}else this.Ec||(this.Jc(s,this.td.kd),this.td.kd&&Cs(t));0===this.Mc&&Cs(t),0===t.touches.length&&this.xc&&(this.xc=!1,Cs(t))}qc(t){if(0!==t.button)return;const i=this.Kc(t);if(this.Tc=null,this.Wc=!1,this.Ic&&(this.Ic(),this.Ic=null),Ss()){this.hd.ownerDocument.documentElement.removeEventListener("mouseleave",this.Uc)}if(!this.Xc(t))if(this.nd(i,this.td.xd),++this.wc,this.gc&&this.wc>1){const{Zc:s}=this.Gc(Ps(t),this.bc);s<5&&!this.Dc&&this.nd(i,this.td.ed),this.rd()}else this.Dc||this.nd(i,this.td.Td)}ad(){null!==this.kc&&(clearTimeout(this.kc),this.kc=null)}Cd(t){if(null!==this.$c)return;const i=t.changedTouches[0];this.$c=i.identifier,this.jc=Ds(t);const s=this.hd.ownerDocument.documentElement;this.Ec=!1,this.Pc=!1,this.zc=!1,this.Cc=Ps(i),this.Lc&&(this.Lc(),this.Lc=null);{const i=this.fd.bind(this),n=this.Sd.bind(this);this.Lc=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",n)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",n,{passive:!1}),this.ad(),this.kc=setTimeout(this.Pd.bind(this,t),240)}const n=this.Kc(t,i);this.Jc(n,this.td.Dd),this.Sc||(this.Mc=0,this.Sc=setTimeout(this.sd.bind(this),500),this.yc=Ps(i))}Ed(t){if(0!==t.button)return;const i=this.hd.ownerDocument.documentElement;Ss()&&i.addEventListener("mouseleave",this.Uc),this.Dc=!1,this.Tc=Ps(t),this.Ic&&(this.Ic(),this.Ic=null);{const t=this.bd.bind(this),s=this.qc.bind(this);this.Ic=()=>{i.removeEventListener("mousemove",t),i.removeEventListener("mouseup",s)},i.addEventListener("mousemove",t),i.addEventListener("mouseup",s)}if(this.Wc=!0,this.Xc(t))return;const s=this.Kc(t);this.nd(s,this.td.Od),this.gc||(this.wc=0,this.gc=setTimeout(this.rd.bind(this),500),this.bc=Ps(t))}ld(){this.hd.addEventListener("mouseenter",this.od.bind(this)),this.hd.addEventListener("touchcancel",this.ad.bind(this));{const t=this.hd.ownerDocument,i=t=>{this.td.Nd&&(t.target&&this.hd.contains(t.target)||this.td.Nd())};this.Nc=()=>{t.removeEventListener("touchstart",i)},this.Oc=()=>{t.removeEventListener("mousedown",i)},t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!0})}ys()&&(this.Rc=()=>{this.hd.removeEventListener("dblclick",this.Yc)},this.hd.addEventListener("dblclick",this.Yc)),this.hd.addEventListener("mouseleave",this.Rd.bind(this)),this.hd.addEventListener("touchstart",this.Cd.bind(this),{passive:!0}),ks(this.hd),this.hd.addEventListener("mousedown",this.Ed.bind(this)),this.Ad(),this.hd.addEventListener("touchmove",(()=>{}),{passive:!1})}Ad(){void 0===this.td.Id&&void 0===this.td.Ld&&void 0===this.td.Vd||(this.hd.addEventListener("touchstart",(t=>this.Bd(t.touches)),{passive:!0}),this.hd.addEventListener("touchmove",(t=>{if(2===t.touches.length&&null!==this.Vc&&void 0!==this.td.Ld){const i=Ts(t.touches[0],t.touches[1])/this.Bc;this.td.Ld(this.Vc,i),Cs(t)}}),{passive:!1}),this.hd.addEventListener("touchend",(t=>{this.Bd(t.touches)})))}Bd(t){1===t.length&&(this.Fc=!1),2!==t.length||this.Fc||this.xc?this.Fd():this.zd(t)}zd(t){const i=this.hd.getBoundingClientRect()||{left:0,top:0};this.Vc={tt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,it:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Bc=Ts(t[0],t[1]),void 0!==this.td.Id&&this.td.Id(),this.ad()}Fd(){null!==this.Vc&&(this.Vc=null,void 0!==this.td.Vd&&this.td.Vd())}Rd(t){if(this.Ac&&this.Ac(),this.Xc(t))return;if(!this.Hc)return;const i=this.Kc(t);this.nd(i,this.td.Wd),this.Hc=!ys()}Pd(t){const i=Es(t.touches,h(this.$c));if(null===i)return;const s=this.Kc(t,i);this.Jc(s,this.td.jd),this.Ec=!0,this.xc=!0}Xc(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:Ds(t)<this.jc+500}Jc(t,i){i&&i.call(this.td,t)}nd(t,i){i&&i.call(this.td,t)}Kc(t,i){const s=i||t,n=this.hd.getBoundingClientRect()||{left:0,top:0};return{$d:s.clientX,Hd:s.clientY,Ud:s.pageX,qd:s.pageY,Yd:s.screenX,Xd:s.screenY,Kd:s.clientX-n.left,Zd:s.clientY-n.top,Gd:t.ctrlKey,Jd:t.altKey,Qd:t.shiftKey,tf:t.metaKey,if:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,sf:t.type,nf:s.target,ef:t.view,rf:()=>{"touchstart"!==t.type&&Cs(t)}}}}function Ts(t,i){const s=t.clientX-i.clientX,n=t.clientY-i.clientY;return Math.sqrt(s*s+n*n)}function Cs(t){t.cancelable&&t.preventDefault()}function Ps(t){return{tt:t.pageX,it:t.pageY}}function Ds(t){return t.timeStamp||performance.now()}function Es(t,i){for(let s=0;s<t.length;++s)if(t[s].identifier===i)return t[s];return null}class Os{constructor(t,i,s,n){if(this.hf=0,this.lf=0,this.af=0,this._f=0,this.uf=0,this.cf=0,this.df=0,this.ff=!1,this.pf=t,this.vf=t.mf()[i],this.wf=t.mf()[s],this.gf=document.createElement("tr"),this.gf.style.height="1px",this.bf=document.createElement("td"),this.bf.style.position="relative",this.bf.style.padding="0",this.bf.style.margin="0",this.bf.setAttribute("colspan","3"),this.Mf(),this.gf.appendChild(this.bf),n)this.Sf=null,this.yf=null;else{this.Sf=document.createElement("div"),this.Sf.style.position="absolute",this.Sf.style.zIndex="50",this.Sf.style.top="-4px",this.Sf.style.height="9px",this.Sf.style.width="100%",this.Sf.style.backgroundColor="",this.Sf.style.cursor="row-resize",this.bf.appendChild(this.Sf);const t={ud:this.kf.bind(this),Wd:this.xf.bind(this),Od:this.Tf.bind(this),Dd:this.Tf.bind(this),Md:this.Cf.bind(this),gd:this.Cf.bind(this),xd:this.Pf.bind(this),yd:this.Pf.bind(this)};this.yf=new xs(this.Sf,t,{md:()=>!1,wd:()=>!0})}}M(){null!==this.yf&&this.yf.M()}Df(){return this.gf}Ef(){return new vs(this.vf.Ef().It,1)}Of(){const t=this.Ef(),i=gs(document,t),s=ws(i);return s.fillStyle=this.pf.B().timeScale.borderColor,s.fillRect(0,0,t.It,t.Lt),i}dt(){this.Mf()}Mf(){this.bf.style.background=this.pf.B().timeScale.borderColor}kf(t){null!==this.Sf&&(this.Sf.style.backgroundColor="hsla(225,8%,72%,.2)")}xf(t){null===this.Sf||this.ff||(this.Sf.style.backgroundColor="")}Tf(t){this.hf=t.qd,this.lf=0,this.af=this.vf.Ef().Lt+this.wf.Ef().Lt,this._f=this.vf.Xa()+this.wf.Xa(),this.uf=30,this.cf=this.af-this.uf,this.df=this._f/this.af,this.ff=!0}Cf(t){this.lf=t.qd-this.hf;const i=this.vf.Ef().Lt,s=St(i+this.lf,this.uf,this.cf)*this.df,n=this._f-s;this.vf.Ka(s),this.wf.Ka(n),this.pf.Nf(),this.vf.Ef().Lt!==i&&(this.hf=t.qd),this.pf.jt().Vh()}Pf(t){this.hf=0,this.lf=0,this.af=0,this._f=0,this.uf=0,this.cf=0,this.df=0,this.ff=!1,this.xf(t)}}function Ns(t,i){return t.Rf-i.Rf}function Rs(t,i,s){const n=(t.Rf-i.Rf)/(t.rt-i.rt);return Math.sign(n)*Math.min(Math.abs(n),s)}class As{constructor(t,i,s,n){this.Af=null,this.If=null,this.Lf=null,this.Vf=null,this.Bf=null,this.Ff=0,this.zf=0,this.Wf=!1,this.jf=t,this.$f=i,this.Hf=s,this.Ns=n}Uf(t,i){if(null!==this.Af){if(this.Af.rt===i)return void(this.Af.Rf=t);if(Math.abs(this.Af.Rf-t)<this.Ns)return}this.Vf=this.Lf,this.Lf=this.If,this.If=this.Af,this.Af={rt:i,Rf:t}}Oe(t,i){if(null===this.Af||null===this.If)return;if(i-this.Af.rt>50)return;let s=0;const n=Rs(this.Af,this.If,this.$f),e=Ns(this.Af,this.If),r=[n],h=[e];if(s+=e,null!==this.Lf){const t=Rs(this.If,this.Lf,this.$f);if(Math.sign(t)===Math.sign(n)){const i=Ns(this.If,this.Lf);if(r.push(t),h.push(i),s+=i,null!==this.Vf){const t=Rs(this.Lf,this.Vf,this.$f);if(Math.sign(t)===Math.sign(n)){const i=Ns(this.Lf,this.Vf);r.push(t),h.push(i),s+=i}}}}let l=0;for(let t=0;t<r.length;++t)l+=h[t]/s*r[t];Math.abs(l)<this.jf||(this.Bf={Rf:t,rt:i},this.zf=l,this.Ff=function(t,i){const s=Math.log(i);return Math.log(1*s/-t)/s}(Math.abs(l),this.Hf))}qf(t){const i=h(this.Bf),s=t-i.rt;return i.Rf+this.zf*(Math.pow(this.Hf,s)-1)/Math.log(this.Hf)}Yf(t){return null===this.Bf||this.Xf(t)===this.Ff}Kf(){return this.Wf}Zf(){this.Wf=!0}Xf(t){const i=t-h(this.Bf).rt;return Math.min(i,this.Ff)}}class Is{constructor(t,i,s,n){this.de=new Bt(200),this.F=0,this.Gf="",this.Je="",this.ae=[],this.Jf=new Map,this.F=t,this.Gf=i,this.Je=C(t,s,n)}M(){this.de.oe(),this.ae=[],this.Jf.clear()}Qf(t,i,s,n,e){const r=this.tp(t,i);if("left"!==e){const i=ms(t.canvas);s-=Math.floor(r.ip*i)}n-=Math.floor(r.Yt/2),t.drawImage(r.sp,s,n,r.qt,r.Yt)}tp(t,i){let s;if(this.Jf.has(i))s=r(this.Jf.get(i));else{if(this.ae.length>=200){const t=r(this.ae.shift());this.Jf.delete(t)}const n=ms(t.canvas),e=Math.ceil(this.F/4.5),h=Math.round(this.F/10),l=Math.ceil(this.de.ti(t,i)),a=xt(Math.round(l+2*e)),o=xt(this.F+2*e),_=gs(document,new vs(a,o));s={Qt:i,ip:Math.round(Math.max(1,l)),qt:Math.ceil(a*n),Yt:Math.ceil(o*n),sp:_},0!==l&&(this.ae.push(s.Qt),this.Jf.set(s.Qt,s)),B(t=ws(s.sp),n,(()=>{t.font=this.Je,t.fillStyle=this.Gf,t.fillText(i,0,o-e-h)}))}return s}}class Ls{constructor(t,i,s,n){this.vi=null,this.np=null,this.ep=!1,this.rp=new Bt(50),this.hp=new Is(11,"#000"),this.Gf=null,this.Je=null,this.lp=0,this.ap=!1,this.op=()=>{this._p(this.xu.B()),this.ap||this.Ni.up().jt().Hr()},this.cp=()=>{this.ap||this.Ni.up().jt().Hr()},this.Ni=t,this.ji=i,this.xu=s,this.dp="left"===n,this.bf=document.createElement("div"),this.bf.style.height="100%",this.bf.style.overflow="hidden",this.bf.style.width="25px",this.bf.style.left="0",this.bf.style.position="relative",this.fp=bs(this.bf,new vs(16,16)),this.fp.subscribeCanvasConfigured(this.op);const e=this.fp.canvas;e.style.position="absolute",e.style.zIndex="1",e.style.left="0",e.style.top="0",this.pp=bs(this.bf,new vs(16,16)),this.pp.subscribeCanvasConfigured(this.cp);const r=this.pp.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0";const h={Od:this.Tf.bind(this),Dd:this.Tf.bind(this),Md:this.Cf.bind(this),gd:this.Cf.bind(this),Nd:this.vp.bind(this),xd:this.Pf.bind(this),yd:this.Pf.bind(this),ed:this.mp.bind(this),Qc:this.mp.bind(this),ud:this.wp.bind(this),Wd:this.xf.bind(this)};this.yf=new xs(this.pp.canvas,h,{md:()=>!1,wd:()=>!0})}M(){this.yf.M(),this.pp.unsubscribeCanvasConfigured(this.cp),this.pp.destroy(),this.fp.unsubscribeCanvasConfigured(this.op),this.fp.destroy(),null!==this.vi&&this.vi.xa().v(this),this.vi=null,this.hp.M()}Df(){return this.bf}et(){return h(this.vi).B().borderColor}gp(){return this.ji.textColor}C(){return this.ji.fontSize}bp(){return C(this.C(),this.ji.fontFamily)}Mp(){const t=this.xu.B(),i=this.Gf!==t.O,s=this.Je!==t.P;return(i||s)&&(this._p(t),this.Gf=t.O),s&&(this.rp.oe(),this.Je=t.P),t}Sp(){if(null===this.vi)return 0;let t=0;const i=this.Mp(),s=ws(this.fp.canvas),n=this.vi.bl();s.font=this.bp(),n.length>0&&(t=Math.max(this.rp.ti(s,n[0].Rl),this.rp.ti(s,n[n.length-1].Rl)));const e=this.yp();for(let i=e.length;i--;){const n=this.rp.ti(s,e[i].Qt());n>t&&(t=n)}const r=this.vi.kt();if(null!==r&&null!==this.np){const i=this.vi.qi(1,r),n=this.vi.qi(this.np.Lt-2,r);t=Math.max(t,this.rp.ti(s,this.vi.gi(Math.floor(Math.min(i,n))+.11111111111111,r)),this.rp.ti(s,this.vi.gi(Math.ceil(Math.max(i,n))-.11111111111111,r)))}const h=t||34;let l=Math.ceil(i.k+i.T+i.R+i.A+h);return l+=l%2,l}kp(t){if(t.It<0||t.Lt<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.np&&this.np.kr(t)||(this.np=t,this.ap=!0,this.fp.resizeCanvas({width:t.It,height:t.Lt}),this.pp.resizeCanvas({width:t.It,height:t.Lt}),this.ap=!1,this.bf.style.width=t.It+"px",this.bf.style.height=t.Lt+"px",this.bf.style.minWidth=t.It+"px")}xp(){return h(this.np).It}Di(t){this.vi!==t&&(null!==this.vi&&this.vi.xa().v(this),this.vi=t,t.xa().l(this.Hl.bind(this),this))}Ct(){return this.vi}oe(){const t=this.Ni.Tp();this.Ni.up().jt().co(t,h(this.Ct()))}Cp(t){if(null===this.np)return;if(1!==t){const t=ws(this.fp.canvas);this.Pp(),this.Dp(t,this.fp.pixelRatio),this.Xn(t,this.fp.pixelRatio),this.Ep(t,this.fp.pixelRatio),this.Op(t,this.fp.pixelRatio)}const i=ws(this.pp.canvas),s=this.np.It,n=this.np.Lt;B(i,this.pp.pixelRatio,(()=>{i.clearRect(0,0,s,n)})),this.Np(i,this.pp.pixelRatio)}Of(){return this.fp.canvas}dt(){var t;null===(t=this.vi)||void 0===t||t.bl()}Tf(t){if(null===this.vi||this.vi.wi()||!this.Ni.up().B().handleScale.axisPressedMouseMove.price)return;const i=this.Ni.up().jt(),s=this.Ni.Tp();this.ep=!0,i.ro(s,this.vi,t.Zd)}Cf(t){if(null===this.vi||!this.Ni.up().B().handleScale.axisPressedMouseMove.price)return;const i=this.Ni.up().jt(),s=this.Ni.Tp(),n=this.vi;i.ho(s,n,t.Zd)}vp(){if(null===this.vi||!this.Ni.up().B().handleScale.axisPressedMouseMove.price)return;const t=this.Ni.up().jt(),i=this.Ni.Tp(),s=this.vi;this.ep&&(this.ep=!1,t.lo(i,s))}Pf(t){if(null===this.vi||!this.Ni.up().B().handleScale.axisPressedMouseMove.price)return;const i=this.Ni.up().jt(),s=this.Ni.Tp();this.ep=!1,i.lo(s,this.vi)}mp(t){this.Ni.up().B().handleScale.axisDoubleClickReset&&this.oe()}wp(t){if(null===this.vi)return;!this.Ni.up().jt().B().handleScale.axisPressedMouseMove.price||this.vi.gr()||this.vi.la()||this.Rp(1)}xf(t){this.Rp(0)}yp(){const t=[],i=null===this.vi?void 0:this.vi;return(s=>{for(let n=0;n<s.length;++n){const e=s[n].hs(this.Ni.Tp(),i);for(let i=0;i<e.length;i++)t.push(e[i])}})(this.Ni.Tp().ba()),t}Dp(t,i){if(null===this.np)return;const s=this.np.It,n=this.np.Lt;B(t,i,(()=>{const i=this.Ni.Tp().jt(),e=i.vc(),r=i.fc();e===r?F(t,0,0,s,n,e):z(t,0,0,s,n,e,r)}))}Xn(t,i){if(null===this.np||null===this.vi||!this.vi.B().borderVisible)return;t.save(),t.fillStyle=this.et();const s=Math.max(1,Math.floor(this.Mp().k*i));let n;n=this.dp?Math.floor(this.np.It*i)-s:0,t.fillRect(n,0,s,Math.ceil(this.np.Lt*i)),t.restore()}Ep(t,i){if(null===this.np||null===this.vi)return;const s=this.vi.bl();t.save(),t.strokeStyle=this.et(),t.font=this.bp(),t.fillStyle=this.et();const n=this.Mp(),e=this.dp?Math.floor((this.np.It-n.T)*i-n.k*i):Math.floor(n.k*i),r=this.dp?Math.round(e-n.R*i):Math.round(e+n.T*i+n.R*i),h=this.dp?"right":"left",l=Math.max(1,Math.floor(i)),a=Math.floor(.5*i),o=this.vi.B();if(o.borderVisible&&o.ticksVisible){const r=Math.round(n.T*i);t.beginPath();for(const n of s)t.rect(e,Math.round(n.pl*i)-a,r,l);t.fill()}t.fillStyle=this.gp();for(const n of s)this.hp.Qf(t,n.Rl,r,Math.round(n.pl*i),h);t.restore()}Pp(){if(null===this.np||null===this.vi)return;let t=this.np.Lt/2;const i=[],s=this.vi.ba().slice(),n=this.Ni.Tp(),e=this.Mp();this.vi===n.ge()&&this.Ni.Tp().ba().forEach((t=>{n.we(t)&&s.push(t)}));const r=this.vi.gt()[0],h=this.vi;s.forEach((s=>{const e=s.hs(n,h);e.forEach((t=>{t.ui(null),t.ci()&&i.push(t)})),r===s&&e.length>0&&(t=e[0].ii())}));const l=i.filter((i=>i.ii()<=t)),a=i.filter((i=>i.ii()>t));l.sort(((t,i)=>i.ii()-t.ii())),l.length&&a.length&&a.push(l[0]),a.sort(((t,i)=>t.ii()-i.ii())),i.forEach((t=>t.ui(t.ii())));if(this.vi.B().alignLabels){for(let t=1;t<l.length;t++){const i=l[t],s=l[t-1],n=s.Yt(e,!1),r=i.ii(),h=s._i();r>h-n&&i.ui(h-n)}for(let t=1;t<a.length;t++){const i=a[t],s=a[t-1],n=s.Yt(e,!0),r=i.ii(),h=s._i();r<h+n&&i.ui(h+n)}}}Op(t,i){if(null===this.np)return;t.save();const s=this.np,n=this.yp(),e=this.Mp(),r=this.dp?"right":"left";n.forEach((n=>{if(n.di()){const l=n.vt(h(this.vi));t.save(),l.U(t,e,this.rp,s.It,r,i),t.restore()}})),t.restore()}Np(t,i){if(null===this.np||null===this.vi)return;t.save();const s=this.np,n=this.Ni.up().jt(),e=[],r=this.Ni.Tp(),l=n.Wu().hs(r,this.vi);l.length&&e.push(l);const a=this.Mp(),o=this.dp?"right":"left";e.forEach((n=>{n.forEach((n=>{t.save(),n.vt(h(this.vi)).U(t,a,this.rp,s.It,o,i),t.restore()}))})),t.restore()}Rp(t){this.bf.style.cursor=1===t?"ns-resize":"default"}Hl(){const t=this.Sp();this.lp<t&&this.Ni.up().jt().Vh(),this.lp=t}_p(t){this.hp.M(),this.hp=new Is(t.C,t.O,t.D)}}function Vs(t,i,s,n,e){t.Y&&t.Y(i,s,n,e)}function Bs(t,i,s,n,e){t.U(i,s,n,e)}function Fs(t,i){return t.rs(i)}function zs(t,i){return t.Ei(i)}function Ws(t,i){return void 0!==t.Zh?t.Zh(i):[]}class js{constructor(t,i){this.np=new vs(0,0),this.Ap=null,this.Ip=null,this.Lp=null,this.Vp=!1,this.Bp=new m,this.Fp=0,this.zp=!1,this.Wp=null,this.jp=!1,this.$p=null,this.Hp=null,this.ap=!1,this.op=()=>{this.ap||null===this.Up||this.Si().Hr()},this.cp=()=>{this.ap||null===this.Up||this.Si().Hr()},this.qp=t,this.Up=i,this.Up.po().l(this.Yp.bind(this),this,!0),this.Xp=document.createElement("td"),this.Xp.style.padding="0",this.Xp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.Kp=document.createElement("td"),this.Kp.style.padding="0",this.Zp=document.createElement("td"),this.Zp.style.padding="0",this.Xp.appendChild(s),this.fp=bs(s,new vs(16,16)),this.fp.subscribeCanvasConfigured(this.op);const n=this.fp.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.pp=bs(s,new vs(16,16)),this.pp.subscribeCanvasConfigured(this.cp);const e=this.pp.canvas;e.style.position="absolute",e.style.zIndex="2",e.style.left="0",e.style.top="0",this.gf=document.createElement("tr"),this.gf.appendChild(this.Kp),this.gf.appendChild(this.Xp),this.gf.appendChild(this.Zp),this.Gp(),this.yf=new xs(this.pp.canvas,this,{md:()=>null===this.Wp&&!this.qp.B().handleScroll.vertTouchDrag,wd:()=>null===this.Wp&&!this.qp.B().handleScroll.horzTouchDrag})}M(){null!==this.Ap&&this.Ap.M(),null!==this.Ip&&this.Ip.M(),this.pp.unsubscribeCanvasConfigured(this.cp),this.pp.destroy(),this.fp.unsubscribeCanvasConfigured(this.op),this.fp.destroy(),null!==this.Up&&this.Up.po().v(this),this.yf.M()}Tp(){return h(this.Up)}Jp(t){null!==this.Up&&this.Up.po().v(this),this.Up=t,null!==this.Up&&this.Up.po().l(js.prototype.Yp.bind(this),this,!0),this.Gp()}up(){return this.qp}Df(){return this.gf}Gp(){if(null!==this.Up&&(this.Qp(),0!==this.Si().ft().length)){if(null!==this.Ap){const t=this.Up.no();this.Ap.Di(h(t))}if(null!==this.Ip){const t=this.Up.eo();this.Ip.Di(h(t))}}}tv(){null!==this.Ap&&this.Ap.dt(),null!==this.Ip&&this.Ip.dt()}Xa(){return null!==this.Up?this.Up.Xa():0}Ka(t){this.Up&&this.Up.Ka(t)}ud(t){if(!this.Up)return;this.iv();const i=t.Kd,s=t.Zd;this.sv(i,s)}Od(t){this.iv(),this.nv(),this.sv(t.Kd,t.Zd)}dd(t){if(!this.Up)return;this.iv();const i=t.Kd,s=t.Zd;this.sv(i,s);const n=this.Qe(i,s);this.Si().Iu(n&&{Lu:n.Lu,ev:n.ev})}Td(t){if(null===this.Up)return;this.iv();const i=t.Kd,s=t.Zd;if(this.Bp.g()){const t=this.Si().Wu().bt(),n=this.Si().ec(h(this.Up));this.Bp.m(t,{x:i,y:s,rc:n})}}Md(t){this.iv(),this.rv(t),this.sv(t.Kd,t.Zd)}xd(t){null!==this.Up&&(this.iv(),this.zp=!1,this.hv(t))}jd(t){if(this.zp=!0,null===this.Wp){const i={x:t.Kd,y:t.Zd};this.lv(i,i)}}Wd(t){null!==this.Up&&(this.iv(),this.Up.jt().Iu(null),this.av())}ov(){return this.Bp}Id(){this.Fp=1,this._v()}Ld(t,i){if(!this.qp.B().handleScale.pinch)return;const s=5*(i-this.Fp);this.Fp=i,this.Si().Zu(t.tt,s)}Dd(t){if(this.zp=!1,this.jp=null!==this.Wp,this.nv(),null!==this.Wp){const i=this.Si().Wu();this.$p={x:i.Xt(),y:i.Kt()},this.Wp={x:t.Kd,y:t.Zd}}}gd(t){if(null===this.Up)return;const i=t.Kd,s=t.Zd;if(null===this.Wp)this.rv(t);else{this.jp=!1;const t=h(this.$p),n=t.x+(i-this.Wp.x),e=t.y+(s-this.Wp.y);this.sv(n,e)}}yd(t){0===this.up().B().trackingMode.exitMode&&(this.jp=!0),this.uv(),this.hv(t)}Qe(t,i){const s=this.Up;if(null===s)return null;const n=s.ba();for(const e of n){const n=this.cv(e.rs(s),t,i);if(null!==n)return{Lu:e,ef:n.ef,ev:n.ev}}return null}dv(t,i){h("left"===i?this.Ap:this.Ip).kp(new vs(t,this.np.Lt))}Ef(){return this.np}kp(t){if(t.It<0||t.Lt<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.np.kr(t)||(this.np=t,this.ap=!0,this.fp.resizeCanvas({width:t.It,height:t.Lt}),this.pp.resizeCanvas({width:t.It,height:t.Lt}),this.ap=!1,this.Xp.style.width=t.It+"px",this.Xp.style.height=t.Lt+"px")}fv(){const t=h(this.Up);t.so(t.no()),t.so(t.eo());for(const i of t.gt())if(t.we(i)){const s=i.Ct();null!==s&&t.so(s),i.os()}}Of(){return this.fp.canvas}Cp(t){if(0===t)return;if(null===this.Up)return;if(t>1&&this.fv(),null!==this.Ap&&this.Ap.Cp(t),null!==this.Ip&&this.Ip.Cp(t),1!==t){const t=ws(this.fp.canvas);t.save(),this.Dp(t,this.fp.pixelRatio),this.Up&&(this.pv(t,this.fp.pixelRatio),this.vv(t,this.fp.pixelRatio),this.mv(t,this.fp.pixelRatio,Fs),this.mv(t,this.fp.pixelRatio,zs)),t.restore()}const i=ws(this.pp.canvas);i.clearRect(0,0,Math.ceil(this.np.It*this.pp.pixelRatio),Math.ceil(this.np.Lt*this.pp.pixelRatio)),this.mv(i,this.fp.pixelRatio,Ws),this.wv(i,this.pp.pixelRatio)}gv(){return this.Ap}bv(){return this.Xp}Mv(){return this.Ip}Yp(){null!==this.Up&&this.Up.po().v(this),this.Up=null}Dp(t,i){B(t,i,(()=>{const i=this.Si(),s=i.vc(),n=i.fc();s===n?F(t,0,0,this.np.It,this.np.Lt,n):z(t,0,0,this.np.It,this.np.Lt,s,n)}))}pv(t,i){const s=h(this.Up),n=s.vo().Ur().vt(s.Yt(),s.qt(),s);null!==n&&(t.save(),n.U(t,i,!1),t.restore())}vv(t,i){const s=this.Si().zu();this.Sv(t,i,Fs,Vs,s),this.Sv(t,i,Fs,Bs,s)}wv(t,i){this.Sv(t,i,Fs,Bs,this.Si().Wu())}mv(t,i,s){const n=h(this.Up).ba();for(const e of n)this.Sv(t,i,s,Vs,e);for(const e of n)this.Sv(t,i,s,Bs,e)}Sv(t,i,s,n,e){const r=h(this.Up),l=s(e,r),a=r.Yt(),o=r.qt(),_=r.jt().Au(),u=null!==_&&_.Lu===e,c=null!==_&&u&&void 0!==_.ev?_.ev.tr:void 0;for(const s of l){const e=s.vt(a,o,r);null!==e&&(t.save(),n(e,t,i,u,c),t.restore())}}cv(t,i,s){const n=h(this.Up);for(const e of t){const t=e.vt(this.np.Lt,this.np.It,n);if(null!==t&&t.Qe){const n=t.Qe(i,s);if(null!==n)return{ef:e,ev:n}}}return null}Qp(){if(null===this.Up)return;const t=this.qp,i=this.Up.no().B().visible,s=this.Up.eo().B().visible;i||null===this.Ap||(this.Kp.removeChild(this.Ap.Df()),this.Ap.M(),this.Ap=null),s||null===this.Ip||(this.Zp.removeChild(this.Ip.Df()),this.Ip.M(),this.Ip=null);const n=t.jt().ac();i&&null===this.Ap&&(this.Ap=new Ls(this,t.B().layout,n,"left"),this.Kp.appendChild(this.Ap.Df())),s&&null===this.Ip&&(this.Ip=new Ls(this,t.B().layout,n,"right"),this.Zp.appendChild(this.Ip.Df()))}yv(t){return t.if&&this.zp||null!==this.Wp}kv(t){return Math.max(0,Math.min(t,this.np.It-1))}xv(t){return Math.max(0,Math.min(t,this.np.Lt-1))}sv(t,i){this.Si().nc(this.kv(t),this.xv(i),h(this.Up))}av(){this.Si().hc()}uv(){this.jp&&(this.Wp=null,this.av())}lv(t,i){this.Wp=t,this.jp=!1,this.sv(i.x,i.y);const s=this.Si().Wu();this.$p={x:s.Xt(),y:s.Kt()}}Si(){return this.qp.jt()}Tv(){const t=this.Si(),i=this.Tp(),s=i.Ui();t._o(i,s),t.tc(),this.Lp=null,this.Vp=!1}hv(t){if(!this.Vp)return;const i=performance.now();if(null!==this.Hp&&this.Hp.Oe(t.Kd,i),null===this.Hp||this.Hp.Yf(i))return void this.Tv();const s=this.Si(),n=s.Mt(),e=this.Hp,r=()=>{if(e.Kf())return;const t=performance.now();let i=e.Yf(t);if(!e.Kf()){const r=n.I_();s.Qu(e.qf(t)),r===n.I_()&&(i=!0,this.Hp=null)}i?this.Tv():requestAnimationFrame(r)};requestAnimationFrame(r)}iv(){this.Wp=null}nv(){if(!this.Up)return;if(this._v(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)h(document.activeElement).blur();else{const t=document.getSelection();null!==t&&t.removeAllRanges()}!this.Up.Ui().wi()&&this.Si().Mt().wi()}rv(t){if(null===this.Up)return;const i=this.Si();if(i.Mt().wi())return;const s=this.qp.B(),n=s.handleScroll,e=s.kineticScroll;if((!n.pressedMouseMove||t.if)&&(!n.horzTouchDrag&&!n.vertTouchDrag||!t.if))return;const r=this.Up.Ui(),h=performance.now();null!==this.Lp||this.yv(t)||(this.Lp={x:t.$d,y:t.Hd,Vo:h,Kd:t.Kd,Zd:t.Zd}),null!==this.Hp&&this.Hp.Uf(t.Kd,h),null===this.Lp||this.Vp||this.Lp.x===t.$d&&this.Lp.y===t.Hd||(null===this.Hp&&(t.if&&e.touch||!t.if&&e.mouse)&&(this.Hp=new As(.2,7,.997,15),this.Hp.Uf(this.Lp.Kd,this.Lp.Vo),this.Hp.Uf(t.Kd,h)),r.wi()||i.ao(this.Up,r,t.Zd),i.Ju(t.Kd),this.Vp=!0),this.Vp&&(r.wi()||i.oo(this.Up,r,t.Zd),i.Qu(t.Kd))}_v(){const t=performance.now(),i=null===this.Hp||this.Hp.Yf(t);null!==this.Hp&&(i||this.Tv()),null!==this.Hp&&(this.Hp.Zf(),this.Hp=null)}}class $s{constructor(t,i,s,n,e){this.hi=!0,this.np=new vs(0,0),this.op=()=>this.Cp(3),this.dp="left"===t,this.xu=s.ac,this.ji=i,this.Cv=n,this.Pv=e,this.bf=document.createElement("div"),this.bf.style.width="25px",this.bf.style.height="100%",this.bf.style.overflow="hidden",this.fp=bs(this.bf,new vs(16,16)),this.fp.subscribeCanvasConfigured(this.op)}M(){this.fp.unsubscribeCanvasConfigured(this.op),this.fp.destroy()}Df(){return this.bf}Ef(){return this.np}kp(t){if(t.It<0||t.Lt<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.np.kr(t)||(this.np=t,this.fp.resizeCanvas({width:t.It,height:t.Lt}),this.bf.style.width=`${t.It}px`,this.bf.style.minWidth=`${t.It}px`,this.bf.style.height=`${t.Lt}px`,this.hi=!0)}Cp(t){if(t<3&&!this.hi)return;if(0===this.np.It||0===this.np.Lt)return;this.hi=!1;const i=ws(this.fp.canvas);this.Dp(i,this.fp.pixelRatio),this.Xn(i,this.fp.pixelRatio)}Of(){return this.fp.canvas}Xn(t,i){if(!this.Cv())return;const s=this.np.It;t.save(),t.fillStyle=this.ji.timeScale.borderColor;const n=Math.floor(this.xu.B().k*i),e=this.dp?Math.round(s*i)-n:0;t.fillRect(e,0,n,n),t.restore()}Dp(t,i){B(t,i,(()=>{F(t,0,0,this.np.It,this.np.Lt,this.Pv())}))}}function Hs(t,i){return t.Yo>i.Yo?t:i}class Us{constructor(t){this.Dv=null,this.Ev=null,this.S=null,this.Ov=!1,this.np=new vs(0,0),this.Nv=new m,this.rp=new Bt(5),this.ap=!1,this.op=()=>{this.ap||this.qp.jt().Hr()},this.cp=()=>{this.ap||this.qp.jt().Hr()},this.qp=t,this.ji=t.B().layout,this.Rv=document.createElement("tr"),this.Av=document.createElement("td"),this.Av.style.padding="0",this.Iv=document.createElement("td"),this.Iv.style.padding="0",this.bf=document.createElement("td"),this.bf.style.height="25px",this.bf.style.padding="0",this.Lv=document.createElement("div"),this.Lv.style.width="100%",this.Lv.style.height="100%",this.Lv.style.position="relative",this.Lv.style.overflow="hidden",this.bf.appendChild(this.Lv),this.fp=bs(this.Lv,new vs(16,16)),this.fp.subscribeCanvasConfigured(this.op);const i=this.fp.canvas;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.pp=bs(this.Lv,new vs(16,16)),this.pp.subscribeCanvasConfigured(this.cp);const s=this.pp.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.Rv.appendChild(this.Av),this.Rv.appendChild(this.bf),this.Rv.appendChild(this.Iv),this.Vv(),this.qp.jt().Ya().l(this.Vv.bind(this),this),this.yf=new xs(this.pp.canvas,this,{md:()=>!0,wd:()=>!1})}M(){this.yf.M(),null!==this.Dv&&this.Dv.M(),null!==this.Ev&&this.Ev.M(),this.pp.unsubscribeCanvasConfigured(this.cp),this.pp.destroy(),this.fp.unsubscribeCanvasConfigured(this.op),this.fp.destroy()}Df(){return this.Rv}Bv(){return this.Dv}Fv(){return this.Ev}Od(t){if(this.Ov)return;this.Ov=!0;const i=this.qp.jt();!i.Mt().wi()&&this.qp.B().handleScale.axisPressedMouseMove.time&&i.Ku(t.Kd)}Dd(t){this.Od(t)}Nd(){const t=this.qp.jt();!t.Mt().wi()&&this.Ov&&(this.Ov=!1,this.qp.B().handleScale.axisPressedMouseMove.time&&t.sc())}Md(t){const i=this.qp.jt();!i.Mt().wi()&&this.qp.B().handleScale.axisPressedMouseMove.time&&i.ic(t.Kd)}gd(t){this.Md(t)}xd(){this.Ov=!1;const t=this.qp.jt();t.Mt().wi()&&!this.qp.B().handleScale.axisPressedMouseMove.time||t.sc()}yd(){this.xd()}ed(){this.qp.B().handleScale.axisDoubleClickReset&&this.qp.jt().Ts()}Qc(){this.ed()}ud(){this.qp.jt().B().handleScale.axisPressedMouseMove.time&&this.Rp(1)}Wd(){this.Rp(0)}Ef(){return this.np}zv(){return this.Nv}Wv(t,i,s){this.np&&this.np.kr(t)||(this.np=t,this.ap=!0,this.fp.resizeCanvas({width:t.It,height:t.Lt}),this.pp.resizeCanvas({width:t.It,height:t.Lt}),this.ap=!1,this.bf.style.width=t.It+"px",this.bf.style.height=t.Lt+"px",this.Nv.m(t)),null!==this.Dv&&this.Dv.kp(new vs(i,t.Lt)),null!==this.Ev&&this.Ev.kp(new vs(s,t.Lt))}jv(){const t=this.$v();return Math.ceil(t.k+t.T+t.C+t.I+t.N)}dt(){this.qp.jt().Mt().bl()}Of(){return this.fp.canvas}Cp(t){if(0===t)return;if(1!==t){const i=ws(this.fp.canvas);this.Dp(i,this.fp.pixelRatio),this.Xn(i,this.fp.pixelRatio),this.Ep(i,this.fp.pixelRatio),null!==this.Dv&&this.Dv.Cp(t),null!==this.Ev&&this.Ev.Cp(t)}const i=ws(this.pp.canvas),s=this.pp.pixelRatio;i.clearRect(0,0,Math.ceil(this.np.It*s),Math.ceil(this.np.Lt*s)),this.Hv([this.qp.jt().Wu()],i,s)}Dp(t,i){B(t,i,(()=>{F(t,0,0,this.np.It,this.np.Lt,this.qp.jt().fc())}))}Xn(t,i){if(this.qp.B().timeScale.borderVisible){t.save(),t.fillStyle=this.Uv();const s=Math.max(1,Math.floor(this.$v().k*i));t.fillRect(0,0,Math.ceil(this.np.It*i),s),t.restore()}}Ep(t,i){const s=this.qp.jt().Mt(),n=s.bl();if(!n||0===n.length)return;let e=n.reduce(Hs,n[0]).Yo;e>30&&e<50&&(e=30),t.save(),t.strokeStyle=this.Uv();const r=this.$v(),h=r.k+r.T+r.I+r.C-r.L;t.textAlign="center",t.fillStyle=this.Uv();const l=Math.floor(this.$v().k*i),a=Math.max(1,Math.floor(i)),o=Math.floor(.5*i),_=s.B();if(_.borderVisible&&_.ticksVisible){t.beginPath();const s=Math.round(r.T*i);for(let e=n.length;e--;){const r=Math.round(n[e].pl*i);t.rect(r-o,l,a,s)}t.fill()}t.fillStyle=this.j(),B(t,i,(()=>{t.font=this.qv();for(const i of n)if(i.Yo<e){const s=i.B_?this.Yv(t,i.pl,i.Rl):i.pl;t.fillText(i.Rl,s,h)}t.font=this.Xv();for(const i of n)if(i.Yo>=e){const s=i.B_?this.Yv(t,i.pl,i.Rl):i.pl;t.fillText(i.Rl,s,h)}})),t.restore()}Yv(t,i,s){const n=this.rp.ti(t,s),e=n/2,r=Math.floor(i-e)+.5;return r<0?i+=Math.abs(0-r):r+n>this.np.It&&(i-=Math.abs(this.np.It-(r+n))),i}Hv(t,i,s){const n=this.$v();for(const e of t)for(const t of e.Oi())i.save(),t.vt().U(i,n,s),i.restore()}Uv(){return this.qp.B().timeScale.borderColor}j(){return this.ji.textColor}F(){return this.ji.fontSize}qv(){return C(this.F(),this.ji.fontFamily)}Xv(){return C(this.F(),this.ji.fontFamily,"bold")}$v(){null===this.S&&(this.S={k:1,L:NaN,I:NaN,N:NaN,Mi:NaN,T:3,C:NaN,P:"",bi:new Bt});const t=this.S,i=this.qv();if(t.P!==i){const s=this.F();t.C=s,t.P=i,t.I=Math.ceil(s/2.5),t.N=t.I,t.Mi=Math.ceil(s/2),t.L=Math.round(this.F()/5),t.bi.oe()}return this.S}Rp(t){this.bf.style.cursor=1===t?"ew-resize":"default"}Vv(){const t=this.qp.jt(),i=t.B();i.leftPriceScale.visible||null===this.Dv||(this.Av.removeChild(this.Dv.Df()),this.Dv.M(),this.Dv=null),i.rightPriceScale.visible||null===this.Ev||(this.Iv.removeChild(this.Ev.Df()),this.Ev.M(),this.Ev=null);const s={ac:this.qp.jt().ac()},n=()=>i.leftPriceScale.borderVisible&&t.Mt().B().borderVisible,e=()=>t.fc();i.leftPriceScale.visible&&null===this.Dv&&(this.Dv=new $s("left",i,s,n,e),this.Av.appendChild(this.Dv.Df())),i.rightPriceScale.visible&&null===this.Ev&&(this.Ev=new $s("right",i,s,n,e),this.Iv.appendChild(this.Ev.Df()))}}class qs{constructor(t,i){var s;this.Kv=[],this.Zv=[],this.Gv=0,this.Ll=0,this.ce=0,this.Jv=0,this.Qv=0,this.tm=null,this.im=!1,this.Bp=new m,this.Mu=new m,this.ji=i,this.Rv=document.createElement("div"),this.Rv.classList.add("tv-lightweight-charts"),this.Rv.style.overflow="hidden",this.Rv.style.width="100%",this.Rv.style.height="100%",(s=this.Rv).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.sm=document.createElement("table"),this.sm.setAttribute("cellspacing","0"),this.Rv.appendChild(this.sm),this.nm=this.rm.bind(this),this.Rv.addEventListener("wheel",this.nm,{passive:!1}),this.Si=new _s(this.ku.bind(this),this.ji),this.jt().ju().l(this.hm.bind(this),this),this.lm=new Us(this),this.sm.appendChild(this.lm.Df());let n=this.ji.width,e=this.ji.height;if(0===n||0===e){const i=t.getBoundingClientRect();0===n&&(n=Math.floor(i.width),n-=n%2),0===e&&(e=Math.floor(i.height),e-=e%2)}this.am(n,e),this.om(),t.appendChild(this.Rv),this._m(),this.Si.Mt().K_().l(this.Si.Vh.bind(this.Si),this),this.Si.Ya().l(this.Si.Vh.bind(this.Si),this)}jt(){return this.Si}B(){return this.ji}mf(){return this.Kv}um(){return this.lm}M(){this.Rv.removeEventListener("wheel",this.nm),0!==this.Gv&&window.cancelAnimationFrame(this.Gv),this.Si.ju().v(this),this.Si.Mt().K_().v(this),this.Si.Ya().v(this),this.Si.M();for(const t of this.Kv)this.sm.removeChild(t.Df()),t.ov().v(this),t.M();this.Kv=[];for(const t of this.Zv)this.dm(t);this.Zv=[],h(this.lm).M(),null!==this.Rv.parentElement&&this.Rv.parentElement.removeChild(this.Rv),this.Mu.M(),this.Bp.M()}am(t,i,s=!1){if(this.Ll===i&&this.ce===t)return;this.Ll=i,this.ce=t;const n=i+"px",e=t+"px";h(this.Rv).style.height=n,h(this.Rv).style.width=e,this.sm.style.height=n,this.sm.style.width=e,s?this.fm(new G(3)):this.Si.Vh()}Cp(t){void 0===t&&(t=new G(3));for(let i=0;i<this.Kv.length;i++)this.Kv[i].Cp(t.Ss(i).gs);this.ji.timeScale.visible&&this.lm.Cp(t.Ms())}$r(t){this.Si.$r(t),this._m();const i=t.width||this.ce,s=t.height||this.Ll;this.am(i,s)}ov(){return this.Bp}ju(){return this.Mu}pm(){null!==this.tm&&(this.fm(this.tm),this.tm=null);const t=this.Kv[0],i=gs(document,new vs(this.ce,this.Ll)),s=ws(i),n=ms(i);return B(s,n,(()=>{let i=0,n=0;const e=t=>{for(let e=0;e<this.Kv.length;e++){const r=this.Kv[e],l=r.Ef().Lt,a=h("left"===t?r.gv():r.Mv()),o=a.Of();if(s.drawImage(o,i,n,a.xp(),l),n+=l,e<this.Kv.length-1){const t=this.Zv[e],r=t.Ef(),h=t.Of();s.drawImage(h,i,n,r.It,r.Lt),n+=r.Lt}}};this.vm()&&(e("left"),i=h(t.gv()).xp()),n=0;for(let t=0;t<this.Kv.length;t++){const e=this.Kv[t],r=e.Ef(),h=e.Of();if(s.drawImage(h,i,n,r.It,r.Lt),n+=r.Lt,t<this.Kv.length-1){const e=this.Zv[t],r=e.Ef(),h=e.Of();s.drawImage(h,i,n,r.It,r.Lt),n+=r.Lt}}i+=t.Ef().It,this.wm()&&(n=0,e("right"));const r=t=>{const e=h("left"===t?this.lm.Bv():this.lm.Fv()),r=e.Ef(),l=e.Of();s.drawImage(l,i,n,r.It,r.Lt)};if(this.ji.timeScale.visible){i=0,this.vm()&&(r("left"),i=h(t.gv()).xp());const e=this.lm.Ef(),l=this.lm.Of();s.drawImage(l,i,n,e.It,e.Lt),this.wm()&&(i+=t.Ef().It,r("right"),s.restore())}})),i}gm(t){if("left"===t&&!this.vm())return 0;if("right"===t&&!this.wm())return 0;if(0===this.Kv.length)return 0;return h("left"===t?this.Kv[0].gv():this.Kv[0].Mv()).xp()}Nf(){this.bm()}bm(){var t;let i=0,s=0,n=0;for(const t of this.Kv)this.vm()&&(s=Math.max(s,h(t.gv()).Sp())),this.wm()&&(n=Math.max(n,h(t.Mv()).Sp())),i+=t.Xa();const e=this.ce,r=this.Ll,l=Math.max(e-s-n,0),a=1*this.Zv.length,o=this.ji.timeScale.visible;let _=o?this.lm.jv():0;_%2&&(_+=1);const u=a+_,c=r<u?0:r-u,d=c/i;let f=0;const p=(null===(t=document.body.ownerDocument.defaultView)||void 0===t?void 0:t.devicePixelRatio)||1;for(let t=0;t<this.Kv.length;++t){const i=this.Kv[t];i.Jp(this.Si.Fu()[t]);let e=0,r=0;r=t===this.Kv.length-1?Math.ceil((c-f)*p)/p:Math.round(i.Xa()*d*p)/p,e=Math.max(r,2),f+=e,i.kp(new vs(l,e)),this.vm()&&i.dv(s,"left"),this.wm()&&i.dv(n,"right"),i.Tp()&&this.Si.$u(i.Tp(),e)}this.lm.Wv(new vs(o?l:0,_),o?s:0,o?n:0),this.Si.Za(l),this.Jv!==s&&(this.Jv=s),this.Qv!==n&&(this.Qv=n)}rm(t){let i=t.deltaX/100,s=-t.deltaY/100;if(0!==i&&this.ji.handleScroll.mouseWheel||0!==s&&this.ji.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,s*=120;break;case t.DOM_DELTA_LINE:i*=32,s*=32}if(0!==s&&this.ji.handleScale.mouseWheel){const i=Math.sign(s)*Math.min(1,Math.abs(s)),n=t.clientX-this.Rv.getBoundingClientRect().left;this.jt().Zu(n,i)}0!==i&&this.ji.handleScroll.mouseWheel&&this.jt().Gu(-80*i)}}fm(t){var i;const s=t.Ms();3===s&&this.Mm(),3!==s&&2!==s||(this.Sm(t),this.ym(t),this.lm.dt(),this.Kv.forEach((t=>{t.tv()})),3===(null===(i=this.tm)||void 0===i?void 0:i.Ms())&&(this.tm.Es(t),this.Mm(),this.Sm(this.tm),this.ym(this.tm),t=this.tm,this.tm=null)),this.Cp(t)}ym(t){const i=t.Ds();for(const t of i)this.Os(t)}Sm(t){const i=this.Si.Fu();for(let s=0;s<i.length;s++)t.Ss(s).bs&&i[s].do()}Os(t){const i=this.Si.Mt();switch(t.ks){case 0:i.G_();break;case 1:i.J_(t.Pt);break;case 2:i.Cs(t.Pt);break;case 3:i.Ps(t.Pt);break;case 4:i.F_()}}ku(t){null!==this.tm?this.tm.Es(t):this.tm=t,this.im||(this.im=!0,this.Gv=window.requestAnimationFrame((()=>{if(this.im=!1,this.Gv=0,null!==this.tm){const t=this.tm;this.tm=null,this.fm(t)}})))}Mm(){this.om()}dm(t){this.sm.removeChild(t.Df()),t.M()}om(){const t=this.Si.Fu(),i=t.length,s=this.Kv.length;for(let t=i;t<s;t++){const t=r(this.Kv.pop());this.sm.removeChild(t.Df()),t.ov().v(this),t.M();const i=this.Zv.pop();void 0!==i&&this.dm(i)}for(let n=s;n<i;n++){const i=new js(this,t[n]);if(i.ov().l(this.km.bind(this),this),this.Kv.push(i),n>0){const t=new Os(this,n-1,n,!1);this.Zv.push(t),this.sm.insertBefore(t.Df(),this.lm.Df())}this.sm.insertBefore(i.Df(),this.lm.Df())}for(let s=0;s<i;s++){const i=t[s],n=this.Kv[s];n.Tp()!==i?n.Jp(i):n.Gp()}this._m(),this.bm()}xm(t,i){var s,n;const e=new Map;if(null!==t){this.Si.ft().forEach((i=>{const s=i.ds()._h(t);null!==s&&e.set(i,s)}))}let r;if(null!==t){const i=null===(s=this.Si.Mt().yi(t))||void 0===s?void 0:s.Xo;void 0!==i&&(r=i)}const h=this.jt().Au(),l=null!==h&&h.Lu instanceof Mi?h.Lu:void 0,a=null!==h&&void 0!==h.ev?h.ev.sr:void 0;return{rt:r,wn:null!=t?t:void 0,Tm:null!=i?i:void 0,rc:null!==(n=null==i?void 0:i.rc)&&void 0!==n?n:void 0,Cm:l,Pm:e,Dm:a}}km(t,i){this.Bp.m((()=>this.xm(t,i)))}hm(t,i){this.Mu.m((()=>this.xm(t,i)))}_m(){const t=this.ji.timeScale.visible?"":"none";this.lm.Df().style.display=t}vm(){return this.Kv[0].Tp().no().B().visible}wm(){return this.Kv[0].Tp().eo().B().visible}}function Ys(t,i,s,n){const e=s.value;return{wn:i,rt:t,Pt:[e,e,e,e],Xo:n}}function Xs(t,i,s,n){const e=s.value,r={wn:i,rt:t,Pt:[e,e,e,e],Xo:n};return"color"in s&&void 0!==s.color&&(r.O=s.color),r}function Ks(t){return void 0!==t.Pt}function Zs(t){return(i,s,n,e)=>{return void 0===(r=n).open&&void 0===r.value?{rt:i,wn:s,Xo:e}:t(i,s,n,e);var r}}const Gs={Candlestick:Zs((function(t,i,s,n){const e={wn:i,rt:t,Pt:[s.open,s.high,s.low,s.close],Xo:n};return"color"in s&&void 0!==s.color&&(e.O=s.color),"borderColor"in s&&void 0!==s.borderColor&&(e.Dt=s.borderColor),"wickColor"in s&&void 0!==s.wickColor&&(e.Gn=s.wickColor),e})),Bar:Zs((function(t,i,s,n){const e={wn:i,rt:t,Pt:[s.open,s.high,s.low,s.close],Xo:n};return"color"in s&&void 0!==s.color&&(e.O=s.color),e})),Area:Zs(Ys),Baseline:Zs(Ys),Histogram:Zs(Xs),Line:Zs(Xs)};function Js(t){return Gs[t]}function Qs(t){return 60*t*60*1e3}function tn(t){return 60*t*1e3}const sn=[{Em:(nn=1,1e3*nn),Yo:10},{Em:tn(1),Yo:20},{Em:tn(5),Yo:21},{Em:tn(30),Yo:22},{Em:Qs(1),Yo:30},{Em:Qs(3),Yo:31},{Em:Qs(6),Yo:32},{Em:Qs(12),Yo:33}];var nn;function en(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(let s=sn.length-1;s>=0;--s)if(Math.floor(i.getTime()/sn[s].Em)!==Math.floor(t.getTime()/sn[s].Em))return sn[s].Yo;return 0}function rn(t,i=0){if(0===t.length)return;let s=0===i?null:t[i-1].rt.Vo,n=null!==s?new Date(1e3*s):null,e=0;for(let r=i;r<t.length;++r){const i=t[r],h=new Date(1e3*i.rt.Vo);null!==n&&(i.qo=en(h,n)),e+=i.rt.Vo-(s||i.rt.Vo),s=i.rt.Vo,n=h}if(0===i&&t.length>1){const i=Math.ceil(e/(t.length-1)),s=new Date(1e3*(t[0].rt.Vo-i));t[0].qo=en(new Date(1e3*t[0].rt.Vo),s)}}function hn(t){if(!cs(t))throw new Error("time must be of type BusinessDay");const i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Vo:Math.round(i.getTime()/1e3),Lo:t}}function ln(t){if(!ds(t))throw new Error("time must be of type isUTCTimestamp");return{Vo:t}}function an(t){return 0===t.length?null:cs(t[0].time)?hn:ln}function on(t){return ds(t)?ln(t):cs(t)?hn(t):hn(_n(t))}function _n(t){const i=new Date(t);if(isNaN(i.getTime()))throw new Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function un(t){M(t.time)&&(t.time=_n(t.time))}function cn(t){return{wn:0,Om:new Map,Kh:t}}function dn(t){if(void 0!==t&&0!==t.length)return{Nm:t[0].rt.Vo,Rm:t[t.length-1].rt.Vo}}function fn(t){let i;return t.forEach((t=>{void 0===i&&(i=t.Xo)})),r(i)}function pn(t){void 0===t.Xo&&(t.Xo=t.time)}class vn{constructor(){this.Am=new Map,this.Im=new Map,this.Lm=new Map,this.Vm=[]}M(){this.Am.clear(),this.Im.clear(),this.Lm.clear(),this.Vm=[]}Bm(t,i){let s=0!==this.Am.size,n=!1;const e=this.Im.get(t);if(void 0!==e)if(1===this.Im.size)s=!1,n=!0,this.Am.clear();else for(const i of this.Vm)i.pointData.Om.delete(t)&&(n=!0);let r=[];if(0!==i.length){const s=i;s.forEach((t=>pn(t))),function(t){t.forEach(un)}(i);const e=h(an(i)),l=Js(t.Xr());r=s.map((i=>{const s=e(i.time);let r=this.Am.get(s.Vo);void 0===r&&(r=cn(s),this.Am.set(s.Vo,r),n=!0);const h=l(s,r.wn,i,i.Xo);return r.Om.set(t,h),h}))}s&&this.Fm(),this.zm(t,r);let l=-1;if(n){const t=[];this.Am.forEach((i=>{t.push({qo:0,rt:i.Kh,pointData:i,Xo:fn(i.Om)})})),t.sort(((t,i)=>t.rt.Vo-i.rt.Vo)),l=this.Wm(t)}return this.jm(t,l,function(t,i){const s=dn(t),n=dn(i);if(void 0!==s&&void 0!==n)return{jh:s.Rm>=n.Rm&&s.Nm>=n.Nm}}(this.Im.get(t),e))}qu(t){return this.Bm(t,[])}$m(t,i){const s=i;pn(s),un(i);const n=h(an([i]))(i.time),e=this.Lm.get(t);if(void 0!==e&&n.Vo<e.Vo)throw new Error(`Cannot update oldest data, last time=${e.Vo}, new time=${n.Vo}`);let r=this.Am.get(n.Vo);const l=void 0===r;void 0===r&&(r=cn(n),this.Am.set(n.Vo,r));const a=Js(t.Xr())(n,r.wn,i,s.Xo);r.Om.set(t,a),this.Hm(t,a);const o={jh:Ks(a)};if(!l)return this.jm(t,-1,o);const _={qo:0,rt:r.Kh,pointData:r,Xo:fn(r.Om)},u=ut(this.Vm,_.rt.Vo,((t,i)=>t.rt.Vo<i));this.Vm.splice(u,0,_);for(let t=u;t<this.Vm.length;++t)mn(this.Vm[t].pointData,t);return rn(this.Vm,u),this.jm(t,u,o)}Hm(t,i){let s=this.Im.get(t);void 0===s&&(s=[],this.Im.set(t,s));const n=0!==s.length?s[s.length-1]:null;null===n||i.rt.Vo>n.rt.Vo?Ks(i)&&s.push(i):Ks(i)?s[s.length-1]=i:s.splice(-1,1),this.Lm.set(t,i.rt)}zm(t,i){0!==i.length?(this.Im.set(t,i.filter(Ks)),this.Lm.set(t,i[i.length-1].rt)):(this.Im.delete(t),this.Lm.delete(t))}Fm(){for(const t of this.Vm)0===t.pointData.Om.size&&this.Am.delete(t.rt.Vo)}Wm(t){let i=-1;for(let s=0;s<this.Vm.length&&s<t.length;++s){const n=this.Vm[s],e=t[s];if(n.rt.Vo!==e.rt.Vo){i=s;break}e.qo=n.qo,mn(e.pointData,s)}if(-1===i&&this.Vm.length!==t.length&&(i=Math.min(this.Vm.length,t.length)),-1===i)return-1;for(let s=i;s<t.length;++s)mn(t[s].pointData,s);return rn(t,i),this.Vm=t,i}Um(){if(0===this.Im.size)return null;let t=0;return this.Im.forEach((i=>{0!==i.length&&(t=Math.max(t,i[i.length-1].wn))})),t}jm(t,i,s){const n={qm:new Map,Mt:{E_:this.Um()}};if(-1!==i)this.Im.forEach(((i,e)=>{n.qm.set(e,{Te:i,Ym:e===t?s:void 0})})),this.Im.has(t)||n.qm.set(t,{Te:[],Ym:s}),n.Mt.Xm=this.Vm,n.Mt.Km=i;else{const i=this.Im.get(t);n.qm.set(t,{Te:i||[],Ym:s})}return n}}function mn(t,i){t.wn=i,t.Om.forEach((t=>{t.wn=i}))}function wn(t){return{value:t.Pt[3],time:t.Xo}}function gn(t){const i=wn(t);return void 0!==t.O&&(i.color=t.O),i}function bn(t){return{open:t.Pt[0],high:t.Pt[1],low:t.Pt[2],close:t.Pt[3],time:t.Xo}}const Mn={Area:wn,Line:gn,Baseline:wn,Histogram:gn,Bar:function(t){const i=bn(t);return void 0!==t.O&&(i.color=t.O),i},Candlestick:function(t){const i=bn(t),{O:s,Dt:n,Gn:e}=t;return void 0!==s&&(i.color=s),void 0!==n&&(i.borderColor=n),void 0!==e&&(i.wickColor=e),i}};function Sn(t){return Mn[t]}const yn={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:""};class kn{constructor(t){this.Br=t}applyOptions(t){this.Br.$r(t)}options(){return this.Br.B()}Zm(){return this.Br}}class xn{constructor(t,i,s){this.tn=t,this.Gm=i,this.Jm=s}priceFormatter(){return this.tn.sl()}priceToCoordinate(t){const i=this.tn.kt();return null===i?null:this.tn.Ct().Tt(t,i.Pt)}coordinateToPrice(t){const i=this.tn.kt();return null===i?null:this.tn.Ct().qi(t,i.Pt)}barsInLogicalRange(t){if(null===t)return null;const i=new ts(new Gi(t.from,t.to)).Qo(),s=this.tn.ds();if(s.wi())return null;const n=s._h(i.Ys(),1),e=s._h(i.Xs(),-1),r=h(s.lh()),l=h(s.cs());if(null!==n&&null!==e&&n.wn>e.wn)return{barsBefore:t.from-r,barsAfter:l-t.to};const a={barsBefore:null===n||n.wn===r?t.from-r:n.wn-r,barsAfter:null===e||e.wn===l?l-t.to:l-e.wn};return null!==n&&null!==e&&(a.from=n.rt.Lo||n.rt.Vo,a.to=e.rt.Lo||e.rt.Vo),a}setData(t){this.tn.Xr(),this.Gm.Qm(this.tn,t)}update(t){this.tn.Xr(),this.Gm.tw(this.tn,t)}dataByIndex(t,i){const s=this.tn.ds()._h(t,i);return null===s?null:Sn(this.seriesType())(s)}setMarkers(t){const i=t.map((t=>Object.assign(Object.assign({},t),{originalTime:t.time,time:on(t.time)})));this.tn.Hh(i)}markers(){return this.tn.Uh().map((t=>{const{originalTime:i,time:s}=t,n=function(t,i){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)i.indexOf(n[e])<0&&Object.prototype.propertyIsEnumerable.call(t,n[e])&&(s[n[e]]=t[n[e]])}return s}(t,["originalTime","time"]);return Object.assign({time:i},n)}))}applyOptions(t){this.tn.$r(t)}options(){return y(this.tn.B())}priceScale(){return this.Jm.priceScale(this.tn.Ct().ll())}createPriceLine(t){const i=w(y(yn),t),s=this.tn.qh(i);return new kn(s)}removePriceLine(t){this.tn.Yh(t.Zm())}seriesType(){return this.tn.Xr()}}class Tn extends xn{applyOptions(t){us(t),super.applyOptions(t)}}const Cn={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!0,scaleMargins:{bottom:.1,top:.2}},Pn={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:T,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},Dn={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:T},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:Object.assign({},Cn),leftPriceScale:Object.assign(Object.assign({},Cn),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},Cn),{visible:!0}),nonPrimaryPriceScale:Object.assign(Object.assign({},Cn),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,ticksVisible:!0},watermark:Pn,localization:{locale:Ms?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},En={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},On={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Nn={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Rn={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},An={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},In={color:"#26a69a",base:0},Ln={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};class Vn{constructor(t,i){this.pf=t,this.iw=i}applyOptions(t){this.pf.jt().Vu(this.iw,t)}options(){return this.vi().B()}width(){return Z(this.iw)?this.pf.gm(this.iw):0}vi(){return h(this.pf.jt().Bu(this.iw)).Ct}}class Bn{constructor(t,i){this.sw=new m,this.o_=new m,this.Nv=new m,this.Si=t,this.Fa=t.Mt(),this.lm=i,this.Fa.Y_().l(this.nw.bind(this)),this.Fa.X_().l(this.ew.bind(this)),this.lm.zv().l(this.rw.bind(this))}M(){this.Fa.Y_().v(this),this.Fa.X_().v(this),this.lm.zv().v(this),this.sw.M(),this.o_.M(),this.Nv.M()}scrollPosition(){return this.Fa.I_()}scrollToPosition(t,i){i?this.Fa.q_(t,1e3):this.Si.Ps(t)}scrollToRealTime(){this.Fa.U_()}getVisibleRange(){var t,i;const s=this.Fa.y_();return null===s?null:{from:null!==(t=s.from.Lo)&&void 0!==t?t:s.from.Vo,to:null!==(i=s.to.Lo)&&void 0!==i?i:s.to.Vo}}setVisibleRange(t){const i={from:on(t.from),to:on(t.to)},s=this.Fa.C_(i);this.Si.uc(s)}getVisibleLogicalRange(){const t=this.Fa.S_();return null===t?null:{from:t.Ys(),to:t.Xs()}}setVisibleLogicalRange(t){e(t.from<=t.to,"The from index cannot be after the to index."),this.Si.uc(t)}resetTimeScale(){this.Si.Ts()}fitContent(){this.Si.G_()}logicalToCoordinate(t){const i=this.Si.Mt();return i.wi()?null:i.Ot(t)}coordinateToLogical(t){return this.Fa.wi()?null:this.Fa.O_(t)}timeToCoordinate(t){const i=on(t),s=this.Fa.ol(i,!1);return null===s?null:this.Fa.Ot(s)}coordinateToTime(t){var i;const s=this.Si.Mt(),n=s.O_(t),e=s.Yi(n);return null===e?null:null!==(i=e.Lo)&&void 0!==i?i:e.Vo}width(){return this.lm.Ef().It}height(){return this.lm.Ef().Lt}subscribeVisibleTimeRangeChange(t){this.sw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.sw.p(t)}subscribeVisibleLogicalRangeChange(t){this.o_.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.o_.p(t)}subscribeSizeChange(t){this.Nv.l(t)}unsubscribeSizeChange(t){this.Nv.p(t)}applyOptions(t){this.Fa.$r(t)}options(){return y(this.Fa.B())}nw(){this.sw.g()&&this.sw.m(this.getVisibleRange())}ew(){this.o_.g()&&this.o_.m(this.getVisibleLogicalRange())}rw(t){this.Nv.m(t.It,t.Lt)}}function Fn(t){if(void 0===t||"custom"===t.type)return;const i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(t);if(Math.abs(s-t)<1e-8)return i;t*=10}return i}(i.minMove))}function zn(t){return function(t){if(S(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale&&S(t.handleScale.axisPressedMouseMove)){const i=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:i,price:i}}const i=t.handleScroll;S(i)&&(t.handleScroll={horzTouchDrag:i,vertTouchDrag:i,mouseWheel:i,pressedMouseMove:i})}(t),t}class Wn{constructor(t,i){this.hw=new vn,this.lw=new Map,this.aw=new Map,this.ow=new m,this._w=new m;const s=void 0===i?y(Dn):w(y(Dn),zn(i));this.pf=new qs(t,s),this.pf.ov().l((t=>{this.ow.g()&&this.ow.m(this.uw(t()))}),this),this.pf.ju().l((t=>{this._w.g()&&this._w.m(this.uw(t()))}),this);const n=this.pf.jt();this.cw=new Bn(n,this.pf.um())}remove(){this.pf.ov().v(this),this.pf.ju().v(this),this.cw.M(),this.pf.M(),this.lw.clear(),this.aw.clear(),this.ow.M(),this._w.M(),this.hw.M()}resize(t,i,s){this.pf.am(t,i,s)}addAreaSeries(t={}){Fn(t.priceFormat);const i=w(y(Ln),Rn,t),s=this.pf.jt().oc("Area",i),n=new xn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}addBaselineSeries(t={}){Fn(t.priceFormat);const i=w(y(Ln),y(An),t),s=this.pf.jt().oc("Baseline",i),n=new xn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}addBarSeries(t={}){Fn(t.priceFormat);const i=w(y(Ln),On,t),s=this.pf.jt().oc("Bar",i),n=new xn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}addCandlestickSeries(t={}){us(t),Fn(t.priceFormat);const i=w(y(Ln),En,t),s=this.pf.jt().oc("Candlestick",i),n=new Tn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}addHistogramSeries(t={}){Fn(t.priceFormat);const i=w(y(Ln),In,t),s=this.pf.jt().oc("Histogram",i),n=new xn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}addLineSeries(t={}){Fn(t.priceFormat);const i=w(y(Ln),Nn,t),s=this.pf.jt().oc("Line",i),n=new xn(s,this,this);return this.lw.set(n,s),this.aw.set(s,n),n}removeSeries(t){const i=r(this.lw.get(t)),s=this.hw.qu(i);this.pf.jt().qu(i),this.dw(s),this.lw.delete(t),this.aw.delete(i)}Qm(t,i){this.dw(this.hw.Bm(t,i))}tw(t,i){this.dw(this.hw.$m(t,i))}subscribeClick(t){this.ow.l(t)}unsubscribeClick(t){this.ow.p(t)}subscribeCrosshairMove(t){this._w.l(t)}unsubscribeCrosshairMove(t){this._w.p(t)}priceScale(t){return new Vn(this.pf,t)}timeScale(){return this.cw}applyOptions(t){this.pf.$r(zn(t))}options(){return this.pf.B()}takeScreenshot(){return this.pf.pm()}removePane(t){this.pf.jt().Uu(t)}swapPane(t,i){this.pf.jt().Yu(t,i)}getPaneElements(){return this.pf.mf().map((t=>t.bv()))}dw(t){const i=this.pf.jt();i.lc(t.Mt.E_,t.Mt.Xm,t.Mt.Km),t.qm.forEach(((t,i)=>i.Z(t.Te,t.Ym))),i.R_()}fw(t){return r(this.aw.get(t))}uw(t){const i=new Map;t.Pm.forEach(((t,s)=>{const n=Sn(s.Xr())(t);e(function(t){return void 0!==t.open||void 0!==t.value}(n)),i.set(this.fw(s),n)}));const s=void 0===t.Cm?void 0:this.fw(t.Cm);return{time:t.rt,logical:t.wn,point:t.Tm,paneIndex:t.rc,hoveredSeries:s,hoveredMarkerId:t.Dm,seriesData:i}}}var jn=Object.freeze({__proto__:null,version:function(){return"4.0.0-dev+202207121500"},get LineStyle(){return i},get LineType(){return t},get TrackingModeExitMode(){return ss},get CrosshairMode(){return X},get MismatchDirection(){return mi},get PriceScaleMode(){return Fi},get PriceLineSource(){return es},get LastPriceAnimationMode(){return ns},get TickMarkType(){return is},get ColorType(){return rs},isBusinessDay:cs,isUTCTimestamp:ds,createChart:function(t,i){let s;if(M(t)){const i=document.getElementById(t);e(null!==i,`Cannot find element in DOM with id=${t}`),s=i}else s=t;return new Wn(s,i)}});window.LightweightCharts=jn}();
